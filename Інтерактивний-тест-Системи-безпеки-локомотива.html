<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π –¢–µ—Å—Ç: –°–∏—Å—Ç–µ–º–∏ –±–µ–∑–ø–µ–∫–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
        
        :root {
            --bg-primary: #f8fafc;
            --bg-secondary: #f1f5f9;
            --bg-card: rgba(255, 255, 255, 0.95);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --accent-primary: #3b82f6;
            --accent-secondary: #6366f1;
            --accent-gradient: linear-gradient(135deg, #3b82f6 0%, #6366f1 100%);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --neutral: #94a3b8;
            --border: #e2e8f0;
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --radius-sm: 6px;
            --radius: 12px;
            --radius-lg: 16px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 24px;
        }

        .test-wrapper {
            width: 100%;
            max-width: 720px;
            background: var(--bg-card);
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border);
            overflow: hidden;
            backdrop-filter: blur(10px);
        }

        .header {
            padding: 32px;
            text-align: center;
            border-bottom: 1px solid var(--border);
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .header h1 {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 8px;
            letter-spacing: -0.02em;
        }

        .header .subtitle {
            font-size: 0.875rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        .content {
            padding: 32px;
        }

        /* Form Styles */
        .form-container {
            max-width: 400px;
            margin: 0 auto;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 6px;
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .form-group input {
            width: 100%;
            padding: 12px 16px;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            font-size: 0.9375rem;
            background: white;
            transition: all 0.2s;
            font-family: inherit;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .current-date {
            text-align: center;
            margin: 24px 0;
            font-size: 0.875rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Button Styles */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            padding: 12px 24px;
            border: none;
            border-radius: var(--radius);
            font-size: 0.9375rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-family: inherit;
            gap: 8px;
        }

        .btn-primary {
            background: var(--accent-gradient);
            color: white;
            box-shadow: 0 4px 6px -1px rgba(59, 130, 246, 0.2);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-1px);
            box-shadow: 0 8px 12px -1px rgba(59, 130, 246, 0.3);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .btn-secondary {
            background: white;
            color: var(--text-primary);
            border: 1px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--bg-secondary);
        }

        .button-container {
            display: flex;
            justify-content: center;
            gap: 12px;
            margin-top: 24px;
        }

        /* Quiz Container */
        #quiz-container {
            display: none;
        }

        .quiz-header {
            margin-bottom: 24px;
        }

        .progress-bar {
            height: 6px;
            background: var(--bg-secondary);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 20px;
        }

        .progress-bar-inner {
            height: 100%;
            background: var(--accent-gradient);
            border-radius: 3px;
            transition: width 0.4s ease;
        }

        .quiz-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-secondary);
        }

        .question-counter {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .question-badge {
            background: var(--accent-primary);
            color: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
        }

        .timer {
            display: flex;
            align-items: center;
            gap: 6px;
            font-variant-numeric: tabular-nums;
        }

        /* Question Styles */
        .question-block {
            animation: fadeIn 0.3s ease;
        }

        .question-title {
            font-size: 1.125rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-bottom: 20px;
            line-height: 1.5;
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .question-points {
            flex-shrink: 0;
            background: var(--accent-primary);
            color: white;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            margin-top: 2px;
        }

        /* Answer Options */
        .answers {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .answers.grid-2-cols {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media (max-width: 640px) {
            .answers.grid-2-cols {
                grid-template-columns: 1fr;
            }
        }

        .answer-option {
            position: relative;
            display: flex;
            align-items: center;
            padding: 14px 16px;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9375rem;
        }

        .answer-option:hover {
            border-color: var(--accent-primary);
            background: #fafafa;
        }

        .answer-option input {
            position: absolute;
            opacity: 0;
        }

        .answer-indicator {
            width: 20px;
            height: 20px;
            border: 2px solid var(--border);
            border-radius: 50%;
            margin-right: 12px;
            flex-shrink: 0;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .answer-option input[type="checkbox"] + .answer-indicator {
            border-radius: 4px;
        }

        .answer-option input:checked + .answer-indicator {
            background: var(--accent-primary);
            border-color: var(--accent-primary);
        }

        .answer-option input:checked + .answer-indicator::after {
            content: '';
            width: 8px;
            height: 8px;
            background: white;
            border-radius: 50%;
        }

        .answer-option input[type="checkbox"]:checked + .answer-indicator::after {
            width: 5px;
            height: 9px;
            border: solid white;
            border-width: 0 2px 2px 0;
            border-radius: 0;
            transform: rotate(45deg);
            margin-bottom: 2px;
        }

        .answer-option.selected {
            border-color: var(--accent-primary);
            background: rgba(59, 130, 246, 0.05);
        }

        /* Fill-in Input */
        .fill-in-container {
            max-width: 300px;
        }

        .fill-in-input {
            width: 100%;
            padding: 12px 16px;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            font-size: 0.9375rem;
            font-family: inherit;
            transition: all 0.2s;
        }

        .fill-in-input:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        /* Matching Question */
        .match-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        @media (max-width: 640px) {
            .match-container {
                grid-template-columns: 1fr;
            }
        }

        .match-source {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .match-target {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .match-item {
            padding: 12px 16px;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: grab;
            font-size: 0.9375rem;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .match-item::before {
            content: '‚ãÆ‚ãÆ';
            color: var(--text-muted);
            font-size: 0.75rem;
            letter-spacing: -1px;
        }

        .match-item:hover {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow);
        }

        .match-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .match-drop-zone {
            min-height: 48px;
            padding: 8px;
            background: var(--bg-secondary);
            border: 2px dashed var(--border);
            border-radius: var(--radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
            font-size: 0.875rem;
            transition: all 0.2s;
        }

        .match-drop-zone.drag-over {
            background: rgba(59, 130, 246, 0.1);
            border-color: var(--accent-primary);
        }

        .match-drop-zone.filled {
            background: white;
            border-style: solid;
            border-color: var(--accent-primary);
            justify-content: flex-start;
        }

        /* Sequence Question */
        .sequence-container {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        @media (max-width: 640px) {
            .sequence-container {
                grid-template-columns: 1fr;
            }
        }

        .sequence-item {
            padding: 14px 16px;
            background: white;
            border: 2px solid var(--border);
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9375rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .sequence-item:hover {
            border-color: var(--accent-primary);
        }

        .sequence-item.selected {
            border-color: var(--accent-primary);
            background: rgba(59, 130, 246, 0.05);
        }

        .sequence-order {
            width: 28px;
            height: 28px;
            background: var(--accent-primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.875rem;
            font-weight: 700;
        }

        .sequence-actions {
            display: flex;
            justify-content: flex-end;
            margin-top: 16px;
        }

        /* Results Container */
        #results-container {
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .results-layout {
            display: grid;
            grid-template-columns: 1fr 280px;
            gap: 24px;
        }

        @media (max-width: 768px) {
            .results-layout {
                grid-template-columns: 1fr;
            }
        }

        .results-main {
            display: flex;
            flex-direction: column;
            gap: 24px;
        }

        .user-info-card {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
            padding: 24px;
            border-radius: var(--radius);
            border: 1px solid var(--border);
        }

        .user-name {
            font-size: 1.5rem;
            font-weight: 800;
            color: var(--text-primary);
            margin-bottom: 4px;
        }

        .user-meta {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 4px;
        }

        .time-display {
            font-size: 0.875rem;
            color: var(--text-muted);
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .answers-grid {
            display: grid;
            grid-template-columns: repeat(8, 1fr);
            gap: 8px;
        }

        @media (max-width: 640px) {
            .answers-grid {
                grid-template-columns: repeat(5, 1fr);
            }
        }

        .answer-cell {
            aspect-ratio: 1;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: var(--radius-sm);
            font-weight: 700;
            font-size: 0.875rem;
            color: white;
        }

        .answer-cell.correct { background: var(--success); }
        .answer-cell.partial { background: var(--warning); }
        .answer-cell.incorrect { background: var(--error); }
        .answer-cell.all-selected { background: var(--neutral); }

        .chart-container {
            margin-top: 24px;
        }

        .chart-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            margin-bottom: 16px;
        }

        .chart {
            display: flex;
            align-items: flex-end;
            gap: 8px;
            height: 120px;
            padding-bottom: 24px;
            border-bottom: 2px solid var(--border);
            position: relative;
        }

        .chart-bar {
            flex: 1;
            background: var(--accent-gradient);
            border-radius: 4px 4px 0 0;
            min-height: 4px;
            position: relative;
            transition: height 0.5s ease;
            animation: growUp 0.5s ease;
        }

        .chart-bar:hover::after {
            content: attr(data-value);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: var(--text-primary);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            white-space: nowrap;
            margin-bottom: 4px;
        }

        .chart-labels {
            display: flex;
            gap: 8px;
            margin-top: 8px;
        }

        .chart-label {
            flex: 1;
            text-align: center;
            font-size: 0.75rem;
            color: var(--text-muted);
        }

        .results-summary {
            background: linear-gradient(135deg, #ecfdf5 0%, #d1fae5 100%);
            padding: 24px;
            border-radius: var(--radius);
            text-align: center;
            border: 1px solid #a7f3d0;
            height: fit-content;
        }

        .results-summary.failed {
            background: linear-gradient(135deg, #fef2f2 0%, #fee2e2 100%);
            border-color: #fecaca;
        }

        .score-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 8px;
        }

        .score-value {
            font-size: 4rem;
            font-weight: 800;
            color: var(--success);
            line-height: 1;
            margin-bottom: 8px;
        }

        .results-summary.failed .score-value {
            color: var(--error);
        }

        .score-details {
            font-size: 0.875rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
        }

        .status-badge {
            display: inline-flex;
            align-items: center;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9375rem;
            font-weight: 700;
            color: white;
            margin-bottom: 20px;
        }

        .status-badge.passed {
            background: var(--success);
        }

        .status-badge.failed {
            background: var(--error);
        }

        .results-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .btn-full {
            width: 100%;
        }

        /* Details Section */
        details {
            background: white;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            overflow: hidden;
        }

        summary {
            padding: 16px 20px;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: space-between;
            list-style: none;
            user-select: none;
        }

        summary::-webkit-details-marker {
            display: none;
        }

        summary::after {
            content: '‚Ä∫';
            font-size: 1.25rem;
            transition: transform 0.2s;
        }

        details[open] summary::after {
            transform: rotate(90deg);
        }

        .details-content {
            padding: 0 20px 20px;
            border-top: 1px solid var(--border);
        }

        .details-section {
            margin-top: 16px;
        }

        .details-section h4 {
            font-size: 0.875rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .details-section h4::before {
            content: '';
            width: 4px;
            height: 16px;
            background: var(--accent-primary);
            border-radius: 2px;
        }

        .details-section ul {
            padding-left: 20px;
            font-size: 0.875rem;
            color: var(--text-secondary);
        }

        .details-section li {
            margin-bottom: 6px;
        }

        /* History Table */
        .history-section {
            margin-top: 24px;
        }

        .history-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.875rem;
        }

        .history-table th,
        .history-table td {
            padding: 10px 12px;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .history-table th {
            font-weight: 600;
            color: var(--text-secondary);
            background: var(--bg-secondary);
        }

        .history-table tr:hover {
            background: var(--bg-secondary);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes growUp {
            from { height: 0; }
        }

        /* Utility */
        .hidden {
            display: none !important;
        }

        .text-center {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="test-wrapper">
        <header class="header">
            <h1>–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è: –°–∏—Å—Ç–µ–º–∏ –±–µ–∑–ø–µ–∫–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞</h1>
            <p class="subtitle">–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞ ‚Ä¢ –°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É ‚Ä¢ –°–ê–£–¢ —Ç–∞ –°–ê–†–¢</p>
        </header>
        
        <main class="content" id="content-area">
            <!-- User Info Form -->
            <div id="user-info-form">
                <div class="form-container">
                    <div class="form-group">
                        <label for="fullName">–ü—Ä—ñ–∑–≤–∏—â–µ, –Ü–º'—è</label>
                        <input type="text" id="fullName" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤–∞—à–µ –ø—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º'—è" required>
                    </div>
                    <div class="form-group">
                        <label for="group">–ì—Ä—É–ø–∞</label>
                        <input type="text" id="group" placeholder="–ù–æ–º–µ—Ä –≥—Ä—É–ø–∏" required>
                    </div>
                    <p class="current-date" id="current-date"></p>
                    <div class="button-container">
                        <button class="btn btn-primary" onclick="startQuiz()">–ü–æ—á–∞—Ç–∏ —Ç–µ—Å—Ç</button>
                    </div>
                </div>
            </div>

            <!-- Quiz Container -->
            <div id="quiz-container">
                <div class="quiz-header">
                    <div class="progress-bar">
                        <div class="progress-bar-inner" id="progress-bar-inner"></div>
                    </div>
                    <div class="quiz-meta">
                        <span class="question-counter">
                            <span class="question-badge" id="question-badge">1/15</span>
                            <span id="question-topic">–¢–µ–º–∞</span>
                        </span>
                        <span class="timer" id="timer">‚è±Ô∏è 00:00</span>
                    </div>
                </div>
                
                <div id="question-display"></div>
                
                <div class="button-container">
                    <button class="btn btn-primary" id="next-btn" onclick="nextQuestion()" disabled>–ù–∞—Å—Ç—É–ø–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è</button>
                </div>
            </div>

            <!-- Results Container -->
            <div id="results-container">
                <div class="results-layout">
                    <div class="results-main">
                        <div class="user-info-card">
                            <div class="user-name" id="result-fullName"></div>
                            <div class="user-meta" id="result-group"></div>
                            <div class="time-display" id="time-taken"></div>
                        </div>

                        <div>
                            <h3 style="font-size: 1rem; font-weight: 600; margin-bottom: 12px; color: var(--text-secondary);">–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</h3>
                            <div class="answers-grid" id="answer-grid"></div>
                        </div>

                        <div class="chart-container" id="chart-container"></div>

                        <details>
                            <summary>–î–µ—Ç–∞–ª—å–Ω–∞ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</summary>
                            <div class="details-content">
                                <div class="details-section">
                                    <h4>–ö—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</h4>
                                    <ul>
                                        <li><strong>1 –±–∞–ª:</strong> –ü–∏—Ç–∞–Ω–Ω—è –Ω–∞ –≤—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—ó (—Ä–∞–¥—ñ–æ–∫–Ω–æ–ø–∫–∏)</li>
                                        <li><strong>2 –±–∞–ª–∏:</strong> –ü–∏—Ç–∞–Ω–Ω—è –Ω–∞ –∞–Ω–∞–ª—ñ–∑ (—á–µ–∫–±–æ–∫—Å–∏, —á–∞—Å—Ç–∫–æ–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ñ)</li>
                                        <li><strong>3 –±–∞–ª–∏:</strong> –ü–∏—Ç–∞–Ω–Ω—è –Ω–∞ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –ª–æ–≥—ñ—á–Ω–∏—Ö –∑–≤'—è–∑–∫—ñ–≤ (–≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å, –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å)</li>
                                    </ul>
                                </div>
                                <div class="details-section">
                                    <h4>–®–∫–∞–ª–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è (12-–±–∞–ª—å–Ω–∞)</h4>
                                    <ul>
                                        <li>92-100% ‚Äî 12 –±–∞–ª—ñ–≤</li>
                                        <li>83-91% ‚Äî 11 –±–∞–ª—ñ–≤</li>
                                        <li>75-82% ‚Äî 10 –±–∞–ª—ñ–≤</li>
                                        <li>67-74% ‚Äî 9 –±–∞–ª—ñ–≤</li>
                                        <li>58-66% ‚Äî 8 –±–∞–ª—ñ–≤</li>
                                        <li>50-57% ‚Äî 7 –±–∞–ª—ñ–≤</li>
                                        <li>42-49% ‚Äî 6 –±–∞–ª—ñ–≤</li>
                                        <li>34-41% ‚Äî 5 –±–∞–ª—ñ–≤</li>
                                        <li>25-33% ‚Äî 4 –±–∞–ª–∏</li>
                                        <li>17-24% ‚Äî 3 –±–∞–ª–∏</li>
                                        <li>9-16% ‚Äî 2 –±–∞–ª–∏</li>
                                        <li>1-8% ‚Äî 1 –±–∞–ª</li>
                                    </ul>
                                </div>
                                <div class="details-section">
                                    <h4>–õ–µ–≥–µ–Ω–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</h4>
                                    <ul>
                                        <li><span style="color: var(--success);">‚ñ†</span> –ó–µ–ª–µ–Ω–∏–π ‚Äî –ø–æ–≤–Ω—ñ—Å—Ç—é –ø—Ä–∞–≤–∏–ª—å–Ω–æ</li>
                                        <li><span style="color: var(--warning);">‚ñ†</span> –ñ–æ–≤—Ç–∏–π ‚Äî —á–∞—Å—Ç–∫–æ–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ</li>
                                        <li><span style="color: var(--neutral);">‚ñ†</span> –°—ñ—Ä–∏–π ‚Äî –æ–±—Ä–∞–Ω–æ –≤—Å—ñ –≤–∞—Ä—ñ–∞–Ω—Ç–∏</li>
                                        <li><span style="color: var(--error);">‚ñ†</span> –ß–µ—Ä–≤–æ–Ω–∏–π ‚Äî –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ</li>
                                    </ul>
                                </div>
                            </div>
                        </details>

                        <div class="history-section" id="history-section" style="display: none;">
                            <h4 style="font-size: 1rem; font-weight: 600; margin-bottom: 12px;">–Ü—Å—Ç–æ—Ä—ñ—è —Å–ø—Ä–æ–±</h4>
                            <table class="history-table">
                                <thead>
                                    <tr>
                                        <th>–î–∞—Ç–∞</th>
                                        <th>–£–º–æ–≤–Ω—ñ –±–∞–ª–∏</th>
                                        <th>–û—Ü—ñ–Ω–∫–∞</th>
                                    </tr>
                                </thead>
                                <tbody id="history-body"></tbody>
                            </table>
                        </div>
                    </div>

                    <div class="results-summary" id="results-summary">
                        <div class="score-title">–ü—ñ–¥—Å—É–º–∫–æ–≤–∞ –æ—Ü—ñ–Ω–∫–∞</div>
                        <div class="score-value" id="final-grade">0</div>
                        <div class="score-details" id="conditional-score">0 / 0 –±–∞–ª—ñ–≤</div>
                        <div class="status-badge" id="status-badge"></div>
                        <div class="results-actions">
                            <button class="btn btn-primary btn-full" id="save-report-btn" onclick="saveReport()">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–≤—ñ—Ç</button>
                            <button class="btn btn-secondary btn-full" onclick="location.reload()">üîÑ –ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑</button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // Test Data - 15 Questions
        const quizData = [
            // –ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞ (5 –ø–∏—Ç–∞–Ω—å)
            {
                topic: "–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞",
                points: 1,
                type: "radio",
                question: "–Ø–∫–µ –æ—Å–Ω–æ–≤–Ω–µ –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è –ø—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω–∏—Ö –≥–∞–ª—å–º?",
                options: [
                    "–ì–∞–ª—å–º—É–≤–∞–Ω–Ω—è –ø–æ—ó–∑–¥–∞ –Ω–∞ –≤–∏—Å–æ–∫—ñ–π —à–≤–∏–¥–∫–æ—Å—Ç—ñ",
                    "–£—Ç—Ä–∏–º–∞–Ω–Ω—è –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞ –≤—ñ–¥ —Å–∞–º–æ–≤—ñ–ª—å–Ω–æ–≥–æ –≤—ñ–¥–∫–∞—Ç—É –Ω–∞ —É—Ö–∏–ª—ñ",
                    "–†–µ–≥—É–ª—é–≤–∞–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ä—É—Ö—É –ø–æ —Å–ø—É—Å–∫—É",
                    "–ê–≤–∞—Ä—ñ–π–Ω–µ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è –ø—Ä–∏ –≤—ñ–¥–º–æ–≤—ñ –ø–Ω–µ–≤–º–∞—Ç–∏—á–Ω–æ–≥–æ –≥–∞–ª—å–º–∞"
                ],
                answer: "–£—Ç—Ä–∏–º–∞–Ω–Ω—è –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞ –≤—ñ–¥ —Å–∞–º–æ–≤—ñ–ª—å–Ω–æ–≥–æ –≤—ñ–¥–∫–∞—Ç—É –Ω–∞ —É—Ö–∏–ª—ñ"
            },
            {
                topic: "–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞",
                points: 2,
                type: "checkbox",
                question: "–Ø–∫—ñ –µ–ª–µ–º–µ–Ω—Ç–∏ –≤—Ö–æ–¥—è—Ç—å –¥–æ —Å–∫–ª–∞–¥—É –º–µ—Ö–∞–Ω—ñ–∑–º—É –ø—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω–æ–≥–æ –≥–∞–ª—å–º–∞?",
                options: [
                    "–ì–∞–ª—å–º—ñ–≤–Ω–∏–π —Ü–∏–ª—ñ–Ω–¥—Ä –∑ –ø–æ—Ä—à–Ω–µ–º",
                    "–ü—Ä—É–∂–∏–Ω–∞ –Ω–∞–∫–∞—Ç–Ω–∏–∫–∞",
                    "–í–∞–∂—ñ–ª—å–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞",
                    "–¢—è–≥–æ–≤–∏–π –µ–ª–µ–∫—Ç—Ä–æ–¥–≤–∏–≥—É–Ω",
                    "–ì–∞–ª—å–º—ñ–≤–Ω—ñ –∫–æ–ª–æ–¥–∫–∏ –∑ –ø—ñ–¥–≤—ñ—Å–∫–æ—é"
                ],
                answer: ["–ì–∞–ª—å–º—ñ–≤–Ω–∏–π —Ü–∏–ª—ñ–Ω–¥—Ä –∑ –ø–æ—Ä—à–Ω–µ–º", "–ü—Ä—É–∂–∏–Ω–∞ –Ω–∞–∫–∞—Ç–Ω–∏–∫–∞", "–í–∞–∂—ñ–ª—å–Ω–∞ –ø–µ—Ä–µ–¥–∞—á–∞", "–ì–∞–ª—å–º—ñ–≤–Ω—ñ –∫–æ–ª–æ–¥–∫–∏ –∑ –ø—ñ–¥–≤—ñ—Å–∫–æ—é"]
            },
            {
                topic: "–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞",
                points: 1,
                type: "radio",
                question: "–Ø–∫–∏–π —Ç–∏–ø –ø—Ä–∏–≤–æ–¥—É –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ —Ä—É—á–Ω–æ–º—É –≥–∞–ª—å–º—ñ —è–∫ –ø—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω–æ–º—É?",
                options: [
                    "–ï–ª–µ–∫—Ç—Ä–∏—á–Ω–∏–π",
                    "–ì—ñ–¥—Ä–∞–≤–ª—ñ—á–Ω–∏–π",
                    "–ú–µ—Ö–∞–Ω—ñ—á–Ω–∏–π (—Ä—É—á–Ω–∏–π)",
                    "–ü–Ω–µ–≤–º–∞—Ç–∏—á–Ω–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π"
                ],
                answer: "–ú–µ—Ö–∞–Ω—ñ—á–Ω–∏–π (—Ä—É—á–Ω–∏–π)"
            },
            {
                topic: "–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞",
                points: 3,
                type: "match",
                question: "–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ –µ–ª–µ–º–µ–Ω—Ç–æ–º —Ç–∞ –π–æ–≥–æ —Ñ—É–Ω–∫—Ü—ñ—î—é:",
                items: ["–ü—Ä—É–∂–∏–Ω–∞ –Ω–∞–∫–∞—Ç–Ω–∏–∫–∞", "–ë–∞–ª–∞–Ω—Å–∏—Ä", "–ì–∞–ª—å–º—ñ–≤–Ω–∞ –∫–æ–ª–æ–¥–∫–∞", "–®—Ç–æ–∫ –ø–æ—Ä—à–Ω—è"],
                definitions: [
                    "–ü–µ—Ä–µ–¥–∞—î –∑—É—Å–∏–ª–ª—è –≤—ñ–¥ –ø–æ—Ä—à–Ω—è –¥–æ –≤–∞–∂–µ–ª—ñ–≤",
                    "–ó–∞–±–µ–∑–ø–µ—á—É—î –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–æ—Ä—à–Ω—è —É –≤–∏—Ö—ñ–¥–Ω–µ –ø–æ–ª–æ–∂–µ–Ω–Ω—è",
                    "–í–∏—Ä—ñ–≤–Ω—é—î –∑—É—Å–∏–ª–ª—è –ø—Ä–∏ –Ω–µ—Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ–º—É –∑–Ω–æ—Å—ñ",
                    "–ë–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑–¥—ñ–π—Å–Ω—é—î –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è –∫–æ–ª–µ—Å–∞"
                ],
                answer: ["–ü—Ä—É–∂–∏–Ω–∞ –Ω–∞–∫–∞—Ç–Ω–∏–∫–∞-–ó–∞–±–µ–∑–ø–µ—á—É—î –ø–æ–≤–µ—Ä–Ω–µ–Ω–Ω—è –ø–æ—Ä—à–Ω—è —É –≤–∏—Ö—ñ–¥–Ω–µ –ø–æ–ª–æ–∂–µ–Ω–Ω—è", "–ë–∞–ª–∞–Ω—Å–∏—Ä-–í–∏—Ä—ñ–≤–Ω—é—î –∑—É—Å–∏–ª–ª—è –ø—Ä–∏ –Ω–µ—Ä—ñ–≤–Ω–æ–º—ñ—Ä–Ω–æ–º—É –∑–Ω–æ—Å—ñ", "–ì–∞–ª—å–º—ñ–≤–Ω–∞ –∫–æ–ª–æ–¥–∫–∞-–ë–µ–∑–ø–æ—Å–µ—Ä–µ–¥–Ω—å–æ –∑–¥—ñ–π—Å–Ω—é—î –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è –∫–æ–ª–µ—Å–∞", "–®—Ç–æ–∫ –ø–æ—Ä—à–Ω—è-–ü–µ—Ä–µ–¥–∞—î –∑—É—Å–∏–ª–ª—è –≤—ñ–¥ –ø–æ—Ä—à–Ω—è –¥–æ –≤–∞–∂–µ–ª—ñ–≤"]
            },
            {
                topic: "–ü—Ä–æ—Ç–∏–≤—ñ–¥–∫–∞—Ç–Ω—ñ –≥–∞–ª—å–º–∞",
                points: 1,
                type: "fill-in",
                question: "–í–∫–∞–∂—ñ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π —É—Ö–∏–ª (—É –ø—Ä–æ–º—ñ–ª–µ), –Ω–∞ —è–∫–æ–º—É —Ä—É—á–Ω–µ –≥–∞–ª—å–º–æ –ø–æ–≤–∏–Ω–Ω–µ —É—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –æ–¥–∏–Ω–æ—á–Ω–∏–π –ª–æ–∫–æ–º–æ—Ç–∏–≤:",
                answer: "30"
            },

            // –°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É (5 –ø–∏—Ç–∞–Ω—å)
            {
                topic: "–°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É",
                points: 1,
                type: "radio",
                question: "–©–æ —Ç–∞–∫–µ ¬´–±—É–∫—Å—É–≤–∞–Ω–Ω—è¬ª –∫–æ–ª—ñ—Å–Ω–∏—Ö –ø–∞—Ä?",
                options: [
                    "–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å –ø—Ä–∏ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—ñ",
                    "–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–µ –ø—Ä–æ–∫–æ–≤–∑—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å –≤—ñ–¥–Ω–æ—Å–Ω–æ —Ä–µ–π–æ–∫ –ø—Ä–∏ —Ç—è–∑—ñ",
                    "–ü–µ—Ä–µ–≥—Ä—ñ–≤ —Ç—è–≥–æ–≤–∏—Ö –¥–≤–∏–≥—É–Ω—ñ–≤",
                    "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è —Ç—è–≥–∏"
                ],
                answer: "–ù–µ–∫–æ–Ω—Ç—Ä–æ–ª—å–æ–≤–∞–Ω–µ –ø—Ä–æ–∫–æ–≤–∑—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å –≤—ñ–¥–Ω–æ—Å–Ω–æ —Ä–µ–π–æ–∫ –ø—Ä–∏ —Ç—è–∑—ñ"
            },
            {
                topic: "–°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É",
                points: 2,
                type: "checkbox",
                question: "–Ø–∫—ñ –Ω–∞—Å–ª—ñ–¥–∫–∏ –º–∞—î —Ç—Ä–∏–≤–∞–ª–µ –±—É–∫—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å–Ω–∏—Ö –ø–∞—Ä?",
                options: [
                    "–£—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–ª–æ—Å–∫–∏—Ö –º—ñ—Å—Ü—å –Ω–∞ –±–∞–Ω–¥–∞–∂–∞—Ö",
                    "–ü–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Ä–µ–π–æ–∫",
                    "–ó–Ω–∏–∂–µ–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∑—á–µ–ø–ª–µ–Ω–Ω—è",
                    "–ü–µ—Ä–µ–≥—Ä—ñ–≤ –ø—ñ–¥—à–∏–ø–Ω–∏–∫—ñ–≤",
                    "–í—Ç—Ä–∞—Ç–∞ —Ç—è–≥–æ–≤–æ—ó —Å–∏–ª–∏"
                ],
                answer: ["–ü–æ—à–∫–æ–¥–∂–µ–Ω–Ω—è –ø–æ–≤–µ—Ä—Ö–Ω—ñ —Ä–µ–π–æ–∫", "–ó–Ω–∏–∂–µ–Ω–Ω—è –∫–æ–µ—Ñ—ñ—Ü—ñ—î–Ω—Ç–∞ –∑—á–µ–ø–ª–µ–Ω–Ω—è", "–í—Ç—Ä–∞—Ç–∞ —Ç—è–≥–æ–≤–æ—ó —Å–∏–ª–∏"]
            },
            {
                topic: "–°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É",
                points: 1,
                type: "radio",
                question: "–©–æ —Ç–∞–∫–µ ¬´–∑—é–∑¬ª (—é–∑) –∫–æ–ª—ñ—Å–Ω–∏—Ö –ø–∞—Ä?",
                options: [
                    "–ü—Ä–æ–∫–æ–≤–∑—É–≤–∞–Ω–Ω—è –ø—Ä–∏ —Ä–æ–∑–≥–æ–Ω—ñ",
                    "–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å –ø—Ä–∏ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—ñ –∑ –∫–æ–≤–∑–∞–Ω–Ω—è–º –ø–æ —Ä–µ–π–∫–∞—Ö",
                    "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è —Ç—è–≥–∏",
                    "–ü–µ—Ä–µ—Ö—ñ–¥ –Ω–∞ —Ä–µ–∫—É–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è"
                ],
                answer: "–ë–ª–æ–∫—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å –ø—Ä–∏ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—ñ –∑ –∫–æ–≤–∑–∞–Ω–Ω—è–º –ø–æ —Ä–µ–π–∫–∞—Ö"
            },
            {
                topic: "–°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É",
                points: 3,
                type: "sequence",
                question: "–†–æ–∑—Ç–∞—à—É–π—Ç–µ —É –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–æ—Ä—è–¥–∫—É –¥—ñ—ó —Å–∏—Å—Ç–µ–º–∏ –∑–∞—Ö–∏—Å—Ç—É –ø—Ä–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—ñ:",
                steps: [
                    "–í–∏—è–≤–ª–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ü—ñ —à–≤–∏–¥–∫–æ—Å—Ç–µ–π –∫–æ–ª—ñ—Å–Ω–∏—Ö –ø–∞—Ä",
                    "–í–∫–ª—é—á–µ–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–ª—è –º–∞—à–∏–Ω—ñ—Å—Ç–∞",
                    "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–Ω–∏–∂–µ–Ω–Ω—è —Ç—è–≥–æ–≤–æ–≥–æ –∑—É—Å–∏–ª–ª—è",
                    "–ü–æ–¥–∞—á–∞ –ø—ñ—Å–∫—É –ø—ñ–¥ –∫–æ–ª—ñ—Å–Ω—ñ –ø–∞—Ä–∏",
                    "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—è–≥–∏ –ø—ñ—Å–ª—è –ø—Ä–∏–ø–∏–Ω–µ–Ω–Ω—è –±—É–∫—Å—É–≤–∞–Ω–Ω—è"
                ],
                answer: ["–í–∏—è–≤–ª–µ–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ü—ñ —à–≤–∏–¥–∫–æ—Å—Ç–µ–π –∫–æ–ª—ñ—Å–Ω–∏—Ö –ø–∞—Ä", "–í–∫–ª—é—á–µ–Ω–Ω—è —Å–∏–≥–Ω–∞–ª—ñ–∑–∞—Ü—ñ—ó –¥–ª—è –º–∞—à–∏–Ω—ñ—Å—Ç–∞", "–ü–æ–¥–∞—á–∞ –ø—ñ—Å–∫—É –ø—ñ–¥ –∫–æ–ª—ñ—Å–Ω—ñ –ø–∞—Ä–∏", "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –∑–Ω–∏–∂–µ–Ω–Ω—è —Ç—è–≥–æ–≤–æ–≥–æ –∑—É—Å–∏–ª–ª—è", "–í—ñ–¥–Ω–æ–≤–ª–µ–Ω–Ω—è —Ç—è–≥–∏ –ø—ñ—Å–ª—è –ø—Ä–∏–ø–∏–Ω–µ–Ω–Ω—è –±—É–∫—Å—É–≤–∞–Ω–Ω—è"]
            },
            {
                topic: "–°–∏—Å—Ç–µ–º–∏ –ø—Ä–æ—Ç–∏ –±—É–∫—Å—É–≤–∞–Ω–Ω—è —Ç–∞ –∑—é–∑—É",
                points: 2,
                type: "radio",
                question: "–Ø–∫–∏–π –ø—Ä–∏—Å—Ç—Ä—ñ–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è –≤–∏—è–≤–ª–µ–Ω–Ω—è –±—É–∫—Å—É–≤–∞–Ω–Ω—è –Ω–∞ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑—ñ –ß–°7?",
                options: [
                    "–¢–∞—Ö–æ–º–µ—Ç—Ä–∏—á–Ω–∏–π –¥–∞—Ç—á–∏–∫ –Ω–∞ –∫–æ–∂–Ω—ñ–π –∫–æ–ª—ñ—Å–Ω—ñ–π –ø–∞—Ä—ñ",
                    "–†–µ–ª–µ –±–æ–∫—Å—É–≤–∞–Ω–Ω—è –∑–∞ —Ä—ñ–∑–Ω–∏—Ü–µ—é –Ω–∞–ø—Ä—É–≥ –Ω–∞ —Ç—è–≥–æ–≤–∏—Ö –¥–≤–∏–≥—É–Ω–∞—Ö",
                    "–î–∞—Ç—á–∏–∫ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∏ –±–∞–Ω–¥–∞–∂—ñ–≤",
                    "–ê–∫—Å–µ–ª–µ—Ä–æ–º–µ—Ç—Ä –∫—É–∑–æ–≤–∞"
                ],
                answer: "–†–µ–ª–µ –±–æ–∫—Å—É–≤–∞–Ω–Ω—è –∑–∞ —Ä—ñ–∑–Ω–∏—Ü–µ—é –Ω–∞–ø—Ä—É–≥ –Ω–∞ —Ç—è–≥–æ–≤–∏—Ö –¥–≤–∏–≥—É–Ω–∞—Ö"
            },

            // –°–ê–£–¢ —Ç–∞ –°–ê–†–¢ (5 –ø–∏—Ç–∞–Ω—å)
            {
                topic: "–°–ê–£–¢ —Ç–∞ –°–ê–†–¢",
                points: 1,
                type: "radio",
                question: "–©–æ –æ–∑–Ω–∞—á–∞—î –∞–±—Ä–µ–≤—ñ–∞—Ç—É—Ä–∞ –°–ê–£–¢?",
                options: [
                    "–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—è–≥–æ—é",
                    "–°–∏—Å—Ç–µ–º–∞ –∞–≤–∞—Ä—ñ–π–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–æ–º",
                    "–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–∏—Å–∫—É",
                    "–°—Ö–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—è–≥–æ–≤–∏–º–∏ –¥–≤–∏–≥—É–Ω–∞–º–∏"
                ],
                answer: "–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ–≥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç—è–≥–æ—é"
            },
            {
                topic: "–°–ê–£–¢ —Ç–∞ –°–ê–†–¢",
                points: 2,
                type: "checkbox",
                question: "–Ø–∫—ñ —Ñ—É–Ω–∫—Ü—ñ—ó –≤–∏–∫–æ–Ω—É—î —Å–∏—Å—Ç–µ–º–∞ –°–ê–£–¢?",
                options: [
                    "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –∑ —Ä–µ–æ—Å—Ç–∞—Ç–Ω–æ–≥–æ –Ω–∞ —Ä–µ–∫—É–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è",
                    "–†–µ–≥—É–ª—é–≤–∞–Ω–Ω—è –º–∞–≥–Ω—ñ—Ç–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É —Ç—è–≥–æ–≤–∏—Ö –¥–≤–∏–≥—É–Ω—ñ–≤",
                    "–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–ø—Ä—É–≥–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ—ó –º–µ—Ä–µ–∂—ñ",
                    "–ó–∞—Ö–∏—Å—Ç –≤—ñ–¥ –±—É–∫—Å—É–≤–∞–Ω–Ω—è –∫–æ–ª—ñ—Å",
                    "–ü—ñ–¥—Ç—Ä–∏–º–∞–Ω–Ω—è –ø–æ—Å—Ç—ñ–π–Ω–æ—ó —à–≤–∏–¥–∫–æ—Å—Ç—ñ —Ä—É—Ö—É"
                ],
                answer: ["–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –ø–µ—Ä–µ—Ö—ñ–¥ –∑ —Ä–µ–æ—Å—Ç–∞—Ç–Ω–æ–≥–æ –Ω–∞ —Ä–µ–∫—É–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è", "–†–µ–≥—É–ª—é–≤–∞–Ω–Ω—è –º–∞–≥–Ω—ñ—Ç–Ω–æ–≥–æ –ø–æ—Ç–æ–∫—É —Ç—è–≥–æ–≤–∏—Ö –¥–≤–∏–≥—É–Ω—ñ–≤", "–ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–ø—Ä—É–≥–∏ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ—ó –º–µ—Ä–µ–∂—ñ"]
            },
            {
                topic: "–°–ê–£–¢ —Ç–∞ –°–ê–†–¢",
                points: 1,
                type: "radio",
                question: "–ü—Ä–∏ —è–∫—ñ–π —É–º–æ–≤—ñ –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –ø–µ—Ä–µ—Ö—ñ–¥ –∑ —Ä–µ–æ—Å—Ç–∞—Ç–Ω–æ–≥–æ –Ω–∞ —Ä–µ–∫—É–ø–µ—Ä–∞—Ç–∏–≤–Ω–µ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º—ñ –°–ê–£–¢?",
                options: [
                    "–ü—Ä–∏ –¥–æ—Å—è–≥–Ω–µ–Ω–Ω—ñ —à–≤–∏–¥–∫–æ—Å—Ç—ñ 50 –∫–º/–≥–æ–¥",
                    "–ö–æ–ª–∏ –ï–†–° –¥–≤–∏–≥—É–Ω—ñ–≤ –¥–æ—Ä—ñ–≤–Ω—é—î –Ω–∞–ø—Ä—É–∑—ñ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ—ó –º–µ—Ä–µ–∂—ñ",
                    "–ü—Ä–∏ –Ω–∞—Ç–∏—Å–∫–∞–Ω–Ω—ñ –∫–Ω–æ–ø–∫–∏ –º–∞—à–∏–Ω—ñ—Å—Ç–æ–º",
                    "–ß–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –ø—ñ—Å–ª—è –ø–æ—á–∞—Ç–∫—É –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è"
                ],
                answer: "–ö–æ–ª–∏ –ï–†–° –¥–≤–∏–≥—É–Ω—ñ–≤ –¥–æ—Ä—ñ–≤–Ω—é—î –Ω–∞–ø—Ä—É–∑—ñ –∫–æ–Ω—Ç–∞–∫—Ç–Ω–æ—ó –º–µ—Ä–µ–∂—ñ"
            },
            {
                topic: "–°–ê–£–¢ —Ç–∞ –°–ê–†–¢",
                points: 3,
                type: "match",
                question: "–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ —Å–∏—Å—Ç–µ–º–æ—é —Ç–∞ —ó—ó –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–Ω—è–º:",
                items: ["–°–ê–£–¢", "–°–ê–†–¢ (—Ç–µ–ø–ª–æ–≤–æ–∑)", "–°–ê–†–¢ (–µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑)", "–ú–ü–°–£"],
                definitions: [
                    "–ü—ñ–¥—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É –¥–∏–∑–µ–ª—è",
                    "–ú—ñ–∫—Ä–æ–ø—Ä–æ—Ü–µ—Å–æ—Ä–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—Å—ñ–º–∞ —Å–∏—Å—Ç–µ–º–∞–º–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞",
                    "–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–µ—Ä–µ—Ö–æ–¥–æ–º –º—ñ–∂ —Ä–µ–∂–∏–º–∞–º–∏ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è",
                    "–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–∏–ª–∏ —Ç—è–≥–∏"
                ],
                answer: ["–°–ê–£–¢-–£–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –ø–µ—Ä–µ—Ö–æ–¥–æ–º –º—ñ–∂ —Ä–µ–∂–∏–º–∞–º–∏ –≥–∞–ª—å–º—É–≤–∞–Ω–Ω—è", "–°–ê–†–¢ (—Ç–µ–ø–ª–æ–≤–æ–∑)-–ü—ñ–¥—Ç—Ä–∏–º–∞–Ω–Ω—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–Ω–æ–≥–æ —Ä–µ–∂–∏–º—É –¥–∏–∑–µ–ª—è", "–°–ê–†–¢ (–µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑)-–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–µ –ø—ñ–¥—Ç—Ä–∏–º–∞–Ω–Ω—è —Å–∏–ª–∏ —Ç—è–≥–∏", "–ú–ü–°–£-–ú—ñ–∫—Ä–æ–ø—Ä–æ—Ü–µ—Å–æ—Ä–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è –≤—Å—ñ–º–∞ —Å–∏—Å—Ç–µ–º–∞–º–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞"]
            },
            {
                topic: "–°–ê–£–¢ —Ç–∞ –°–ê–†–¢",
                points: 1,
                type: "fill-in",
                question: "–í–∫–∞–∂—ñ—Ç—å –¥—ñ–∞–ø–∞–∑–æ–Ω —Ä–µ–≥—É–ª—é–≤–∞–Ω–Ω—è —Å—Ç—Ä—É–º—É –∑–±—É–¥–∂–µ–Ω–Ω—è –≤ —Å–∏—Å—Ç–µ–º—ñ –°–ê–£–¢ (–≤—ñ–¥ __ –¥–æ __ –ê):",
                answer: "50-250"
            }
        ];

        // State
        let currentQuestionIndex = 0;
        let userAnswers = new Array(quizData.length);
        let questionTimings = [];
        let questionStartTime;
        let timerInterval;
        let studentData = {};
        let sequenceCounter = 1;

        // Initialize
        document.getElementById('current-date').innerText = new Date().toLocaleDateString('uk-UA', {
            weekday: 'long',
            year: 'numeric',
            month: 'long',
            day: 'numeric'
        });

        function startQuiz() {
            const fullName = document.getElementById('fullName').value.trim();
            const group = document.getElementById('group').value.trim();
            
            if (!fullName || !group) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –ø–æ–ª—è');
                return;
            }

            studentData = { fullName, group };
            document.getElementById('result-fullName').innerText = fullName;
            document.getElementById('result-group').innerText = `–ì—Ä—É–ø–∞: ${group}`;
            
            document.getElementById('user-info-form').style.display = 'none';
            document.getElementById('quiz-container').style.display = 'block';
            
            startTimer();
            renderQuestion();
        }

        function startTimer() {
            const startTime = Date.now();
            timerInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const minutes = Math.floor(elapsed / 60000);
                const seconds = Math.floor((elapsed % 60000) / 1000);
                document.getElementById('timer').innerText = 
                    `‚è±Ô∏è ${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
            }, 1000);
        }

        function renderQuestion() {
            const q = quizData[currentQuestionIndex];
            questionStartTime = Date.now();
            sequenceCounter = 1;
            
            document.getElementById('question-badge').innerText = `${currentQuestionIndex + 1}/${quizData.length}`;
            document.getElementById('question-topic').innerText = q.topic;
            
            const display = document.getElementById('question-display');
            let html = `
                <div class="question-block" id="current-question" data-type="${q.type}">
                    <div class="question-title">
                        ${q.question}
                        <span class="question-points">${q.points} ${q.points === 1 ? '–±–∞–ª' : '–±–∞–ª–∏'}</span>
                    </div>
            `;

            switch(q.type) {
                case 'radio':
                    const isCompact = q.options.length <= 2;
                    html += `<div class="answers ${isCompact ? '' : 'grid-2-cols'}">`;
                    q.options.forEach(opt => {
                        html += `
                            <label class="answer-option">
                                <input type="radio" name="answer" value="${opt}" onchange="checkAnswer()">
                                <span class="answer-indicator"></span>
                                <span class="answer-text">${opt}</span>
                            </label>
                        `;
                    });
                    html += '</div>';
                    break;

                case 'checkbox':
                    html += `<div class="answers grid-2-cols">`;
                    q.options.forEach(opt => {
                        html += `
                            <label class="answer-option">
                                <input type="checkbox" name="answer" value="${opt}" onchange="checkAnswer()">
                                <span class="answer-indicator"></span>
                                <span class="answer-text">${opt}</span>
                            </label>
                        `;
                    });
                    html += '</div>';
                    break;

                case 'fill-in':
                    html += `
                        <div class="fill-in-container">
                            <input type="text" class="fill-in-input" id="fill-answer" placeholder="–í–≤–µ–¥—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å..." oninput="checkAnswer()">
                        </div>
                    `;
                    break;

                case 'match':
                    const shuffledItems = [...q.items].sort(() => Math.random() - 0.5);
                    html += `
                        <div class="match-container">
                            <div class="match-source">
                                <h4 style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 10px;">–ï–ª–µ–º–µ–Ω—Ç–∏</h4>
                                ${shuffledItems.map(item => `
                                    <div class="match-item" draggable="true" data-id="${item}" ondragstart="dragStart(event)" ondragend="dragEnd(event)">
                                        ${item}
                                    </div>
                                `).join('')}
                            </div>
                            <div class="match-target">
                                <h4 style="font-size: 0.875rem; color: var(--text-secondary); margin-bottom: 10px;">–í–∏–∑–Ω–∞—á–µ–Ω–Ω—è</h4>
                                ${q.definitions.map((def, idx) => `
                                    <div class="match-drop-zone" data-target="${q.items[idx]}" ondragover="dragOver(event)" ondrop="drop(event)" ondragleave="dragLeave(event)">
                                        <span style="font-size: 0.8125rem;">${def}</span>
                                    </div>
                                `).join('')}
                            </div>
                        </div>
                    `;
                    break;

                case 'sequence':
                    const shuffledSteps = [...q.steps].sort(() => Math.random() - 0.5);
                    html += `
                        <div class="sequence-container">
                            ${shuffledSteps.map(step => `
                                <div class="sequence-item" onclick="toggleSequence(this)" data-id="${step}">
                                    <span>${step}</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="sequence-actions">
                            <button class="btn btn-secondary" onclick="resetSequence()" style="padding: 8px 16px; font-size: 0.875rem;">–°–∫–∏–Ω—É—Ç–∏ –ø–æ—Ä—è–¥–æ–∫</button>
                        </div>
                    `;
                    break;
            }

            html += '</div>';
            display.innerHTML = html;
            
            updateProgress();
            document.getElementById('next-btn').innerText = 
                currentQuestionIndex === quizData.length - 1 ? '–ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–µ—Å—Ç' : '–ù–∞—Å—Ç—É–ø–Ω–µ –ø–∏—Ç–∞–Ω–Ω—è';
            document.getElementById('next-btn').disabled = true;
        }

        function checkAnswer() {
            const q = quizData[currentQuestionIndex];
            const questionEl = document.getElementById('current-question');
            let isValid = false;

            switch(q.type) {
                case 'radio':
                    isValid = !!questionEl.querySelector('input[name="answer"]:checked');
                    break;
                case 'checkbox':
                    isValid = questionEl.querySelectorAll('input[name="answer"]:checked').length > 0;
                    break;
                case 'fill-in':
                    isValid = document.getElementById('fill-answer').value.trim() !== '';
                    break;
                case 'match':
                    isValid = document.querySelectorAll('.match-source .match-item').length === 0;
                    break;
                case 'sequence':
                    const selected = questionEl.querySelectorAll('.sequence-item.selected');
                    isValid = selected.length === q.steps.length;
                    break;
            }

            document.getElementById('next-btn').disabled = !isValid;
        }

        // Drag and Drop
        function dragStart(e) {
            e.dataTransfer.setData('text/plain', e.target.dataset.id);
            e.target.classList.add('dragging');
        }

        function dragEnd(e) {
            e.target.classList.remove('dragging');
        }

        function dragOver(e) {
            e.preventDefault();
            e.currentTarget.classList.add('drag-over');
        }

        function dragLeave(e) {
            e.currentTarget.classList.remove('drag-over');
        }

        function drop(e) {
            e.preventDefault();
            const zone = e.currentTarget;
            zone.classList.remove('drag-over');
            
            const itemId = e.dataTransfer.getData('text/plain');
            const item = document.querySelector(`.match-item[data-id="${itemId}"]`);
            
            if (item && !zone.querySelector('.match-item')) {
                zone.innerHTML = '';
                zone.appendChild(item);
                zone.classList.add('filled');
                checkAnswer();
            }
        }

        // Sequence
        function toggleSequence(el) {
            if (!el.classList.contains('selected')) {
                el.classList.add('selected');
                const orderSpan = document.createElement('span');
                orderSpan.className = 'sequence-order';
                orderSpan.innerText = sequenceCounter++;
                el.appendChild(orderSpan);
                checkAnswer();
            }
        }

        function resetSequence() {
            document.querySelectorAll('.sequence-item.selected').forEach(item => {
                item.classList.remove('selected');
                const order = item.querySelector('.sequence-order');
                if (order) order.remove();
            });
            sequenceCounter = 1;
            checkAnswer();
        }

        function collectAnswer() {
            const q = quizData[currentQuestionIndex];
            const questionEl = document.getElementById('current-question');

            switch(q.type) {
                case 'radio':
                    const radio = questionEl.querySelector('input[name="answer"]:checked');
                    userAnswers[currentQuestionIndex] = radio ? radio.value : null;
                    break;
                case 'checkbox':
                    const checkboxes = questionEl.querySelectorAll('input[name="answer"]:checked');
                    userAnswers[currentQuestionIndex] = Array.from(checkboxes).map(cb => cb.value);
                    break;
                case 'fill-in':
                    userAnswers[currentQuestionIndex] = document.getElementById('fill-answer').value.trim();
                    break;
                case 'match':
                    const matches = [];
                    document.querySelectorAll('.match-drop-zone').forEach(zone => {
                        const item = zone.querySelector('.match-item');
                        if (item) {
                            matches.push(`${item.dataset.id}-${zone.dataset.target}`);
                        }
                    });
                    userAnswers[currentQuestionIndex] = matches.sort();
                    break;
                case 'sequence':
                    const items = Array.from(questionEl.querySelectorAll('.sequence-item.selected'));
                    items.sort((a, b) => {
                        const orderA = parseInt(a.querySelector('.sequence-order').innerText);
                        const orderB = parseInt(b.querySelector('.sequence-order').innerText);
                        return orderA - orderB;
                    });
                    userAnswers[currentQuestionIndex] = items.map(item => item.dataset.id);
                    break;
            }
        }

        function nextQuestion() {
            questionTimings.push(Date.now() - questionStartTime);
            collectAnswer();
            currentQuestionIndex++;
            
            if (currentQuestionIndex < quizData.length) {
                renderQuestion();
            } else {
                finishQuiz();
            }
        }

        function updateProgress() {
            const progress = ((currentQuestionIndex) / quizData.length) * 100;
            document.getElementById('progress-bar-inner').style.width = `${progress}%`;
        }

        function finishQuiz() {
            clearInterval(timerInterval);
            updateProgress();
            document.getElementById('progress-bar-inner').style.width = '100%';
            
            let conditionalScore = 0;
            const results = quizData.map((q, i) => {
                const userAns = userAnswers[i];
                
                if (q.type === 'checkbox') {
                    if (!userAns || userAns.length === 0) return 'incorrect';
                    if (userAns.length === q.options.length) return 'all-selected';
                    
                    const incorrect = userAns.filter(a => !q.answer.includes(a)).length;
                    if (incorrect > 0) return 'incorrect';
                    
                    const correct = userAns.filter(a => q.answer.includes(a)).length;
                    conditionalScore += correct;
                    return correct === q.answer.length ? 'correct' : 'partial';
                } else {
                    let isCorrect = false;
                    if (Array.isArray(q.answer)) {
                        isCorrect = JSON.stringify([...userAns].sort()) === JSON.stringify([...q.answer].sort());
                    } else {
                        isCorrect = (userAns || '').toString().toLowerCase() === q.answer.toString().toLowerCase();
                    }
                    
                    if (isCorrect) conditionalScore += q.points;
                    return isCorrect ? 'correct' : 'incorrect';
                }
            });

            const maxScore = quizData.reduce((sum, q) => {
                if (q.type === 'checkbox') return sum + q.answer.length;
                return sum + q.points;
            }, 0);

            const grade = convertTo12Point(conditionalScore, maxScore);
            saveAttempt(conditionalScore, maxScore, grade);
            
            document.getElementById('quiz-container').style.display = 'none';
            document.getElementById('results-container').style.display = 'block';
            
            displayResults(results, conditionalScore, maxScore, grade);
        }

        function convertTo12Point(score, max) {
            if (max === 0) return 0;
            const percent = (score / max) * 100;
            
            if (percent >= 92) return 12;
            if (percent >= 83) return 11;
            if (percent >= 75) return 10;
            if (percent >= 67) return 9;
            if (percent >= 58) return 8;
            if (percent >= 50) return 7;
            if (percent >= 42) return 6;
            if (percent >= 34) return 5;
            if (percent >= 25) return 4;
            if (percent >= 17) return 3;
            if (percent >= 9) return 2;
            if (percent > 0) return 1;
            return 0;
        }

        function displayResults(results, score, maxScore, grade) {
            const totalTime = questionTimings.reduce((a, b) => a + b, 0);
            const minutes = Math.floor(totalTime / 60000);
            const seconds = Math.floor((totalTime % 60000) / 1000);
            
            document.getElementById('time-taken').innerHTML = 
                `‚è±Ô∏è –ó–∞–≥–∞–ª—å–Ω–∏–π —á–∞—Å: <strong>${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}</strong>`;
            
            document.getElementById('answer-grid').innerHTML = results.map((res, i) => 
                `<div class="answer-cell ${res}">${i + 1}</div>`
            ).join('');
            
            document.getElementById('conditional-score').innerText = `${score} / ${maxScore} –±–∞–ª—ñ–≤`;
            
            // Animate grade
            let currentGrade = 0;
            const gradeEl = document.getElementById('final-grade');
            const interval = setInterval(() => {
                gradeEl.innerText = currentGrade;
                if (currentGrade >= grade) {
                    clearInterval(interval);
                } else {
                    currentGrade++;
                }
            }, 50);
            
            const summary = document.getElementById('results-summary');
            const badge = document.getElementById('status-badge');
            
            if (grade >= 4) {
                badge.innerText = '‚úì –ó–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ';
                badge.className = 'status-badge passed';
                summary.classList.remove('failed');
            } else {
                badge.innerText = '‚úó –ù–µ –∑–∞—Ä–∞—Ö–æ–≤–∞–Ω–æ';
                badge.className = 'status-badge failed';
                summary.classList.add('failed');
            }
            
            renderChart();
            displayHistory();
        }

        function renderChart() {
            const maxTime = Math.max(...questionTimings, 1);
            const chartHtml = `
                <div class="chart-title">–ß–∞—Å –Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å (—Å–µ–∫—É–Ω–¥–∏)</div>
                <div class="chart">
                    ${questionTimings.map((time, i) => `
                        <div class="chart-bar" style="height: ${(time / maxTime) * 100}%" data-value="${(time / 1000).toFixed(1)}—Å"></div>
                    `).join('')}
                </div>
                <div class="chart-labels">
                    ${questionTimings.map((_, i) => `<div class="chart-label">${i + 1}</div>`).join('')}
                </div>
            `;
            document.getElementById('chart-container').innerHTML = chartHtml;
        }

        function saveAttempt(score, maxScore, grade) {
            const history = JSON.parse(localStorage.getItem('safety_systems_quiz') || '[]');
            history.push({
                name: studentData.fullName,
                group: studentData.group,
                score: `${score}/${maxScore}`,
                grade: grade,
                date: new Date().toLocaleString('uk-UA')
            });
            localStorage.setItem('safety_systems_quiz', JSON.stringify(history));
        }

        function displayHistory() {
            const history = JSON.parse(localStorage.getItem('safety_systems_quiz') || '[]');
            const userHistory = history.filter(h => h.name === studentData.fullName);
            
            if (userHistory.length > 1) {
                document.getElementById('history-section').style.display = 'block';
                document.getElementById('history-body').innerHTML = userHistory
                    .slice(0, -1)
                    .reverse()
                    .map(h => `
                        <tr>
                            <td>${h.date}</td>
                            <td>${h.score}</td>
                            <td><strong>${h.grade}</strong></td>
                        </tr>
                    `).join('');
            }
        }

        function saveReport() {
            const btn = document.getElementById('save-report-btn');
            const originalText = btn.innerText;
            btn.innerText = '–ó–±–µ—Ä—ñ–≥–∞—î–º–æ...';
            btn.disabled = true;
            
            const styles = document.querySelector('style').innerText;
            const reportContent = document.getElementById('results-container').outerHTML;
            const header = document.querySelector('.header').outerHTML;
            
            const html = `<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ó–≤—ñ—Ç: ${studentData.fullName}</title>
    <style>${styles}</style>
    <style>
        body { align-items: flex-start; padding: 20px; }
        .test-wrapper { margin: 0 auto; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
        #results-container { display: block !important; }
        .results-actions { display: none !important; }
        details { display: none !important; }
    </style>
</head>
<body>
    <div class="test-wrapper">
        ${header}
        <main class="content">${reportContent}</main>
    </div>
</body>
</html>`;
            
            const blob = new Blob([html], { type: 'text/html' });
            const link = document.createElement('a');
            const dateStr = new Date().toISOString().split('T')[0];
            const name = studentData.fullName.replace(/[^a-z–∞-—è—ñ—ó—î“ë0-9]/gi, '_').toLowerCase();
            
            link.download = `zvit_${name}_${dateStr}.html`;
            link.href = URL.createObjectURL(blob);
            link.click();
            URL.revokeObjectURL(link.href);
            
            setTimeout(() => {
                btn.innerText = originalText;
                btn.disabled = false;
            }, 1000);
        }
    </script>
</body>
</html>