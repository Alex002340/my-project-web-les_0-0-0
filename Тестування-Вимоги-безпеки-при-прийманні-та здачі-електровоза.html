<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è: –í–∏–º–æ–≥–∏ –±–µ–∑–ø–µ–∫–∏ –ø—Ä–∏ –ø—Ä–∏–π–º–∞–Ω–Ω—ñ —Ç–∞ –∑–¥–∞—á—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary: #1a365d;
            --secondary: #2c5282;
            --accent: #ed8936;
            --danger: #e53e3e;
            --success: #38a169;
            --warning: #d69e2e;
            --bg: #f7fafc;
            --card: #ffffff;
            --text: #2d3748;
            --text-light: #718096;
            --border: #e2e8f0;
            --shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
        }

        html {
            scroll-behavior: smooth;
            -webkit-overflow-scrolling: touch;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Progress Bar */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 3px;
            background: var(--accent);
            z-index: 1000;
            transition: width 0.1s ease-out;
            width: 0%;
        }

        /* Navigation */
        .nav-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            z-index: 999;
            transform: translateY(-100%);
            transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .nav-header.visible {
            transform: translateY(0);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .nav-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: var(--primary);
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 70%;
        }

        .nav-stats {
            font-size: 0.8rem;
            color: var(--text-light);
            background: var(--bg);
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
        }

        /* Container */
        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 0 1.5rem 4rem;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 6rem 1.5rem 3rem;
            margin-bottom: 2rem;
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: -50%;
            right: -20%;
            width: 600px;
            height: 600px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 50%;
            animation: float 20s infinite ease-in-out;
        }

        @keyframes float {
            0%, 100% { transform: translate(0, 0) rotate(0deg); }
            50% { transform: translate(-30px, -30px) rotate(180deg); }
        }

        .hero-content {
            max-width: 800px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
            text-align: center;
        }

        .hero-badge {
            display: inline-block;
            background: var(--accent);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            margin-bottom: 1rem;
        }

        .hero h1 {
            font-size: clamp(1.5rem, 5vw, 2.5rem);
            font-weight: 800;
            line-height: 1.2;
            margin-bottom: 1rem;
        }

        .hero-subtitle {
            font-size: 1rem;
            opacity: 0.9;
            line-height: 1.6;
        }

        /* Cards */
        .card {
            background: var(--card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            animation: fadeIn 0.6s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-header {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            margin-bottom: 1.5rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid var(--border);
        }

        .card-icon {
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.25rem;
        }

        .card-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: var(--primary);
        }

        /* Form Styles */
        .form-group {
            margin-bottom: 1.25rem;
        }

        .form-label {
            display: block;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 0.5rem;
            font-size: 0.95rem;
        }

        .form-input {
            width: 100%;
            padding: 0.875rem 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            transition: all 0.2s;
            background: white;
        }

        .form-input:focus {
            outline: none;
            border-color: var(--secondary);
            box-shadow: 0 0 0 3px rgba(44, 82, 130, 0.1);
        }

        .form-input:disabled {
            background: var(--bg);
            color: var(--text-light);
        }

        /* Buttons */
        .btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            padding: 0.875rem 1.5rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            width: 100%;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .btn-primary {
            background: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background: var(--secondary);
        }

        .btn-success {
            background: var(--success);
            color: white;
        }

        .btn-success:hover {
            background: #2f855a;
        }

        .btn-secondary {
            background: var(--bg);
            color: var(--text);
            border: 2px solid var(--border);
        }

        .btn-secondary:hover {
            background: var(--border);
        }

        .btn-group {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .btn-group .btn {
            flex: 1;
        }

        /* Question Card */
        .question-card {
            background: var(--card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border-left: 4px solid transparent;
            animation: fadeIn 0.6s ease-out;
        }

        .question-card.correct {
            border-left-color: var(--success);
            background: linear-gradient(to right, #f0fff4 0%, white 100%);
        }

        .question-card.partial {
            border-left-color: var(--warning);
            background: linear-gradient(to right, #fffbeb 0%, white 100%);
        }

        .question-card.incorrect {
            border-left-color: var(--danger);
            background: linear-gradient(to right, #fff5f5 0%, white 100%);
        }

        .question-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 1rem;
            gap: 1rem;
        }

        .question-number {
            background: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.9rem;
            flex-shrink: 0;
        }

        .question-type {
            font-size: 0.75rem;
            color: var(--text-light);
            background: var(--bg);
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            white-space: nowrap;
        }

        .question-text {
            font-size: 1.05rem;
            font-weight: 600;
            color: var(--text);
            margin-bottom: 1.25rem;
            line-height: 1.5;
        }

        .question-points {
            font-size: 0.8rem;
            color: var(--accent);
            font-weight: 600;
            margin-bottom: 1rem;
        }

        /* Options */
        .options-list {
            list-style: none;
            padding: 0;
        }

        .option-item {
            margin-bottom: 0.75rem;
        }

        .option-label {
            display: flex;
            align-items: flex-start;
            gap: 0.75rem;
            padding: 1rem;
            background: var(--bg);
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.2s;
            border: 2px solid transparent;
        }

        .option-label:hover {
            background: #edf2f7;
        }

        .option-label.selected {
            border-color: var(--secondary);
            background: #ebf8ff;
        }

        .option-label.correct {
            border-color: var(--success);
            background: #f0fff4;
        }

        .option-label.incorrect {
            border-color: var(--danger);
            background: #fff5f5;
        }

        .option-input {
            width: 20px;
            height: 20px;
            margin-top: 2px;
            accent-color: var(--primary);
            cursor: pointer;
            flex-shrink: 0;
        }

        .option-text {
            flex: 1;
            font-size: 0.95rem;
            color: var(--text);
        }

        /* Sequence */
        .sequence-container {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .sequence-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            background: var(--bg);
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: move;
            transition: all 0.2s;
        }

        .sequence-item.dragging {
            opacity: 0.5;
        }

        .sequence-number {
            width: 32px;
            height: 32px;
            background: var(--primary);
            color: white;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            flex-shrink: 0;
        }

        .sequence-text {
            flex: 1;
            font-size: 0.95rem;
        }

        .sequence-handle {
            color: var(--text-light);
            font-size: 1.25rem;
            cursor: grab;
        }

        .sequence-handle:active {
            cursor: grabbing;
        }

        /* Matching */
        .matching-container {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1rem;
        }

        @media (min-width: 768px) {
            .matching-container {
                grid-template-columns: 1fr auto 1fr;
            }
        }

        .matching-column {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .matching-item {
            padding: 0.875rem;
            background: var(--bg);
            border-radius: 10px;
            border: 2px solid transparent;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9rem;
        }

        .matching-item:hover {
            border-color: var(--secondary);
        }

        .matching-item.selected {
            border-color: var(--accent);
            background: #fffaf0;
        }

        .matching-item.matched {
            border-color: var(--success);
            background: #f0fff4;
        }

        .matching-item.wrong {
            border-color: var(--danger);
            background: #fff5f5;
        }

        .matching-arrow {
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            color: var(--text-light);
        }

        /* Results */
        .results-header {
            text-align: center;
            padding: 2rem;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            border-radius: 16px;
            margin-bottom: 2rem;
        }

        .results-score {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
        }

        .results-label {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .results-details {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .result-stat {
            background: var(--card);
            padding: 1.25rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: var(--shadow);
        }

        .result-stat-value {
            font-size: 1.75rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.25rem;
        }

        .result-stat-label {
            font-size: 0.875rem;
            color: var(--text-light);
        }

        /* Legend */
        .legend {
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: var(--bg);
            border-radius: 10px;
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .legend-color {
            width: 20px;
            height: 20px;
            border-radius: 4px;
        }

        .legend-color.correct { background: var(--success); }
        .legend-color.partial { background: var(--warning); }
        .legend-color.incorrect { background: var(--danger); }
        .legend-color.unanswered { background: var(--border); }

        /* Answer Grid */
        .answer-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(40px, 1fr));
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }

        .answer-cell {
            aspect-ratio: 1;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 0.875rem;
            color: white;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .answer-cell:hover {
            transform: scale(1.1);
        }

        .answer-cell.correct { background: var(--success); }
        .answer-cell.partial { background: var(--warning); }
        .answer-cell.incorrect { background: var(--danger); }
        .answer-cell.unanswered { background: var(--border); color: var(--text-light); }

        /* Report */
        .report-section {
            margin-bottom: 2rem;
        }

        .report-title {
            font-size: 1.1rem;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 1rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .report-table {
            width: 100%;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .report-table th,
        .report-table td {
            padding: 0.75rem;
            text-align: left;
            border-bottom: 1px solid var(--border);
        }

        .report-table th {
            background: var(--bg);
            font-weight: 600;
            color: var(--primary);
        }

        .report-table tr:hover {
            background: var(--bg);
        }

        /* Hidden */
        .hidden {
            display: none !important;
        }

        /* Timer */
        .timer {
            position: fixed;
            top: 80px;
            right: 1.5rem;
            background: var(--card);
            padding: 0.75rem 1rem;
            border-radius: 10px;
            box-shadow: var(--shadow-lg);
            font-weight: 700;
            color: var(--primary);
            z-index: 998;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .timer.warning {
            color: var(--danger);
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        /* Responsive */
        @media (min-width: 768px) {
            .hero {
                padding: 8rem 2rem 4rem;
            }

            .container {
                padding: 0 2rem 6rem;
            }

            .btn {
                width: auto;
            }

            .btn-group {
                justify-content: flex-end;
            }
        }

        @media print {
            .nav-header, .timer, .btn-group {
                display: none !important;
            }
        }
    </style>
</head>
<body>

    <!-- Progress Bar -->
    <div class="progress-bar" id="progressBar"></div>

    <!-- Timer -->
    <div class="timer hidden" id="timer">
        <span>‚è±Ô∏è</span>
        <span id="timerText">30:00</span>
    </div>

    <!-- Navigation -->
    <header class="nav-header" id="navHeader">
        <div class="nav-container">
            <div class="nav-title">–¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è –∑ –æ—Ö–æ—Ä–æ–Ω–∏ –ø—Ä–∞—Ü—ñ</div>
            <div class="nav-stats" id="navStats">–ü–∏—Ç–∞–Ω–Ω—è 1/15</div>
        </div>
    </header>

    <!-- Hero -->
    <section class="hero">
        <div class="hero-content">
            <span class="hero-badge">–û–Ω–ª–∞–π–Ω-—Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è</span>
            <h1>–í–∏–º–æ–≥–∏ –±–µ–∑–ø–µ–∫–∏ –ø—Ä–∏ –ø—Ä–∏–π–º–∞–Ω–Ω—ñ —Ç–∞ –∑–¥–∞—á—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞</h1>
            <p class="hero-subtitle">–ü–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–Ω–∞–Ω—å –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω–∏—Ö –≤–∏–º–æ–≥ —Ç–∞ –ø—Ä–∞–≤–∏–ª –æ—Ö–æ—Ä–æ–Ω–∏ –ø—Ä–∞—Ü—ñ</p>
        </div>
    </section>

    <!-- Main Content -->
    <main class="container">

        <!-- Registration Form -->
        <div id="registrationForm">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üìù</div>
                    <h2 class="card-title">–†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è –¥–ª—è –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è —Ç–µ—Å—Ç—É</h2>
                </div>
                
                <div class="form-group">
                    <label class="form-label">–ü—Ä—ñ–∑–≤–∏—â–µ, —ñ–º'—è, –ø–æ –±–∞—Ç—å–∫–æ–≤—ñ *</label>
                    <input type="text" class="form-input" id="userName" placeholder="–í–≤–µ–¥—ñ—Ç—å –ü–Ü–ë" required>
                </div>

                <div class="form-group">
                    <label class="form-label">–ì—Ä—É–ø–∞/–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª *</label>
                    <input type="text" class="form-input" id="userGroup" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ú–°-21, –î–µ–ø–æ –•–∞—Ä–∫—ñ–≤" required>
                </div>

                <div class="form-group">
                    <label class="form-label">–î–∞—Ç–∞ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è</label>
                    <input type="text" class="form-input" id="testDate" disabled>
                </div>

                <div class="form-group">
                    <label class="form-label">–Ü–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è –ø—Ä–æ —Ç–µ—Å—Ç</label>
                    <div style="background: var(--bg); padding: 1rem; border-radius: 10px; font-size: 0.9rem; color: var(--text-light);">
                        <p style="margin-bottom: 0.5rem;">‚Ä¢ 15 –ø–∏—Ç–∞–Ω—å —Ä—ñ–∑–Ω–∏—Ö —Ç–∏–ø—ñ–≤</p>
                        <p style="margin-bottom: 0.5rem;">‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∏–π –±–∞–ª: 20</p>
                        <p style="margin-bottom: 0.5rem;">‚Ä¢ –ß–∞—Å –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è: 30 —Ö–≤–∏–ª–∏–Ω</p>
                        <p>‚Ä¢ –ú—ñ–Ω—ñ–º–∞–ª—å–Ω–∏–π –±–∞–ª –¥–ª—è –∑–¥–∞—á—ñ: 12 (60%)</p>
                    </div>
                </div>

                <button class="btn btn-primary" onclick="startTest()">
                    –†–æ–∑–ø–æ—á–∞—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è ‚Üí
                </button>
            </div>
        </div>

        <!-- Test Container -->
        <div id="testContainer" class="hidden">
            <div id="questionsList"></div>
            
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="prevQuestion()">‚Üê –ù–∞–∑–∞–¥</button>
                <button class="btn btn-primary" onclick="nextQuestion()">–î–∞–ª—ñ ‚Üí</button>
            </div>
            
            <div style="text-align: center; margin-top: 2rem;">
                <button class="btn btn-success" onclick="finishTest()" style="max-width: 300px;">
                    ‚úì –ó–∞–≤–µ—Ä—à–∏—Ç–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è
                </button>
            </div>
        </div>

        <!-- Results Container -->
        <div id="resultsContainer" class="hidden">
            
            <!-- Results Header -->
            <div class="results-header">
                <div class="results-score" id="finalScore">0/20</div>
                <div class="results-label" id="scoreLabel">–û—Ü—ñ–Ω–∫–∞: 0/10</div>
            </div>

            <!-- Stats -->
            <div class="results-details">
                <div class="result-stat">
                    <div class="result-stat-value" id="correctCount">0</div>
                    <div class="result-stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="partialCount">0</div>
                    <div class="result-stat-label">–ß–∞—Å—Ç–∫–æ–≤–æ</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="incorrectCount">0</div>
                    <div class="result-stat-label">–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="timeSpent">00:00</div>
                    <div class="result-stat-label">–ß–∞—Å</div>
                </div>
                <div class="result-stat">
                    <div class="result-stat-value" id="attemptNumber">1</div>
                    <div class="result-stat-label">–°–ø—Ä–æ–±–∞</div>
                </div>
            </div>

            <!-- Legend -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üé®</div>
                    <h3 class="card-title">–õ–µ–≥–µ–Ω–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤</h3>
                </div>
                <div class="legend">
                    <div class="legend-item">
                        <div class="legend-color correct"></div>
                        <span>–ü—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color partial"></div>
                        <span>–ß–∞—Å—Ç–∫–æ–≤–æ –ø—Ä–∞–≤–∏–ª—å–Ω–∞</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color incorrect"></div>
                        <span>–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å</span>
                    </div>
                    <div class="legend-item">
                        <div class="legend-color unanswered"></div>
                        <span>–ë–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ</span>
                    </div>
                </div>
            </div>

            <!-- Answer Grid -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üî≤</div>
                    <h3 class="card-title">–í—ñ–∑—É–∞–ª—ñ–∑–∞—Ü—ñ—è –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π</h3>
                </div>
                <div class="answer-grid" id="answerGrid"></div>
                <p style="font-size: 0.875rem; color: var(--text-light); text-align: center;">
                    –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–≤–∞–¥—Ä–∞—Ç–∏–∫ –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥—É –¥–æ –ø–∏—Ç–∞–Ω–Ω—è
                </p>
            </div>

            <!-- Detailed Report -->
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">üìä</div>
                    <h3 class="card-title">–î–µ—Ç–∞–ª—å–Ω–∏–π –∑–≤—ñ—Ç –ø—Ä–æ –ø—Ä–æ—Ö–æ–¥–∂–µ–Ω–Ω—è</h3>
                </div>

                <!-- Respondent Info -->
                <div class="report-section">
                    <h4 class="report-title">üë§ –î–∞–Ω—ñ —Ä–µ—Å–ø–æ–Ω–¥–µ–Ω—Ç–∞</h4>
                    <table class="report-table">
                        <tr>
                            <th>–ü–Ü–ë</th>
                            <td id="reportName">-</td>
                        </tr>
                        <tr>
                            <th>–ì—Ä—É–ø–∞/–ü—ñ–¥—Ä–æ–∑–¥—ñ–ª</th>
                            <td id="reportGroup">-</td>
                        </tr>
                        <tr>
                            <th>–î–∞—Ç–∞ —Ç–∞ —á–∞—Å</th>
                            <td id="reportDateTime">-</td>
                        </tr>
                        <tr>
                            <th>–¢—Ä–∏–≤–∞–ª—ñ—Å—Ç—å</th>
                            <td id="reportDuration">-</td>
                        </tr>
                        <tr>
                            <th>–ù–æ–º–µ—Ä —Å–ø—Ä–æ–±–∏</th>
                            <td id="reportAttempt">-</td>
                        </tr>
                    </table>
                </div>

                <!-- Scoring System -->
                <div class="report-section">
                    <h4 class="report-title">üìã –°–∏—Å—Ç–µ–º–∞ –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</h4>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–¢–∏–ø –ø–∏—Ç–∞–Ω–Ω—è</th>
                                <th>–ë–∞–ª–∏</th>
                                <th>–ö—Ä–∏—Ç–µ—Ä—ñ—ó –æ—Ü—ñ–Ω—é–≤–∞–Ω–Ω—è</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>–û–¥–∏–Ω–æ—á–Ω–∏–π –≤–∏–±—ñ—Ä (1 –ø—Ä–∞–≤–∏–ª—å–Ω–∞)</td>
                                <td>1 –±–∞–ª</td>
                                <td>–ü–æ–≤–Ω–∏–π –±–∞–ª –∑–∞ –ø—Ä–∞–≤–∏–ª—å–Ω—É –≤—ñ–¥–ø–æ–≤—ñ–¥—å</td>
                            </tr>
                            <tr>
                                <td>–ú–Ω–æ–∂–∏–Ω–Ω–∏–π –≤–∏–±—ñ—Ä (2 –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∑ 4)</td>
                                <td>2 –±–∞–ª–∏</td>
                                <td>1 –±–∞–ª –∑–∞ 1 –ø—Ä–∞–≤–∏–ª—å–Ω—É, 2 –±–∞–ª–∏ –∑–∞ –æ–±–∏–¥–≤—ñ</td>
                            </tr>
                            <tr>
                                <td>–ú–Ω–æ–∂–∏–Ω–Ω–∏–π –≤–∏–±—ñ—Ä (3 –ø—Ä–∞–≤–∏–ª—å–Ω—ñ –∑ 6)</td>
                                <td>3 –±–∞–ª–∏</td>
                                <td>1 –±–∞–ª –∑–∞ –∫–æ–∂–Ω—É –ø—Ä–∞–≤–∏–ª—å–Ω—É, –º—ñ–Ω—É—Å 0.5 –∑–∞ –ø–æ–º–∏–ª–∫—É</td>
                            </tr>
                            <tr>
                                <td>–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å</td>
                                <td>2 –±–∞–ª–∏</td>
                                <td>0.5 –±–∞–ª –∑–∞ –∫–æ–∂–Ω—É –ø—Ä–∞–≤–∏–ª—å–Ω—É –ø–æ–∑–∏—Ü—ñ—é</td>
                            </tr>
                            <tr>
                                <td>–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å</td>
                                <td>2-4 –±–∞–ª–∏</td>
                                <td>–ó–∞–ª–µ–∂–Ω–æ –≤—ñ–¥ –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –ø–∞—Ä (0.5-1 –±–∞–ª –∑–∞ –ø–∞—Ä—É)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Results Conversion -->
                <div class="report-section">
                    <h4 class="report-title">üéØ –ü–µ—Ä–µ—Ä–∞—Ö—É–Ω–æ–∫ –±–∞–ª—ñ–≤</h4>
                    <div style="background: var(--bg); padding: 1rem; border-radius: 10px; margin-bottom: 1rem;">
                        <p style="margin-bottom: 0.5rem;"><strong>–§–æ—Ä–º—É–ª–∞:</strong> –û—Ü—ñ–Ω–∫–∞ = (–ù–∞–±—Ä–∞–Ω—ñ –±–∞–ª–∏ / –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –±–∞–ª–∏) √ó 10</p>
                        <p style="font-size: 0.9rem; color: var(--text-light);">
                            –ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ñ –±–∞–ª–∏: 20 | –ù–∞–±—Ä–∞–Ω—ñ: <span id="calcEarned">0</span> | –û—Ü—ñ–Ω–∫–∞: <span id="calcFinal">0</span>/10
                        </p>
                    </div>
                    <table class="report-table">
                        <thead>
                            <tr>
                                <th>–®–∫–∞–ª–∞ –æ—Ü—ñ–Ω–æ–∫</th>
                                <th>–†–µ–∑—É–ª—å—Ç–∞—Ç</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>9-10 –±–∞–ª—ñ–≤</td>
                                <td style="color: var(--success); font-weight: 600;">–í—ñ–¥–º—ñ–Ω–Ω–æ</td>
                            </tr>
                            <tr>
                                <td>7-8 –±–∞–ª—ñ–≤</td>
                                <td style="color: var(--secondary); font-weight: 600;">–î–æ–±—Ä–µ</td>
                            </tr>
                            <tr>
                                <td>6 –±–∞–ª—ñ–≤</td>
                                <td style="color: var(--warning); font-weight: 600;">–ó–∞–¥–æ–≤—ñ–ª—å–Ω–æ</td>
                            </tr>
                            <tr>
                                <td>0-5 –±–∞–ª—ñ–≤</td>
                                <td style="color: var(--danger); font-weight: 600;">–ù–µ–∑–∞–¥–æ–≤—ñ–ª—å–Ω–æ</td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <!-- Question Details -->
                <div class="report-section">
                    <h4 class="report-title">üìã –î–µ—Ç–∞–ª—ñ–∑–∞—Ü—ñ—è –∑–∞ –ø–∏—Ç–∞–Ω–Ω—è–º–∏</h4>
                    <div id="questionsDetail"></div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="btn-group">
                <button class="btn btn-secondary" onclick="restartTest()">
                    üîÑ –ü—Ä–æ–π—Ç–∏ —â–µ —Ä–∞–∑
                </button>
                <button class="btn btn-primary" onclick="window.print()">
                    üñ®Ô∏è –î—Ä—É–∫—É–≤–∞—Ç–∏ –∑–≤—ñ—Ç
                </button>
            </div>
        </div>

    </main>

    <script>
        // Test Data
        const testData = [
            {
                id: 1,
                type: 'single',
                points: 1,
                question: '–©–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î –∞–±—Ä–µ–≤—ñ–∞—Ç—É—Ä–∞ –ù–ü–ê–û–ü?',
                options: [
                    '–ù–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ',
                    '–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ',
                    '–ù–æ–≤–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ',
                    '–ù–∞–≤—á–∞–ª—å–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ'
                ],
                correct: [1],
                explanation: '–ù–ü–ê–û–ü ‚Äî —Ü–µ –ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ, –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–π –¥–æ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç, –∑–∞—Ç–≤–µ—Ä–¥–∂–µ–Ω–∏–π –Ω–∞—Ü—ñ–æ–Ω–∞–ª—å–Ω–∏–º–∏ –æ—Ä–≥–∞–Ω–∞–º–∏ –≤–ª–∞–¥–∏.'
            },
            {
                id: 2,
                type: 'single',
                points: 1,
                question: '–Ø–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç —Ñ—ñ–∫—Å—É—î –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞ –ø—Ä–∏ –∑–¥–∞—á—ñ?',
                options: [
                    '–§–æ—Ä–º–∞ –î–£-61',
                    '–ñ—É—Ä–Ω–∞–ª —Ñ–æ—Ä–º–∏ –¢–£-152',
                    '–¶–¢-0056',
                    '–ù–ü–ê–û–ü 60.1-1.48-00'
                ],
                correct: [1],
                explanation: '–ñ—É—Ä–Ω–∞–ª —Ñ–æ—Ä–º–∏ –¢–£-152 ‚Äî –ø–µ—Ä–≤–∏–Ω–Ω–∏–π –æ–±–ª—ñ–∫–æ–≤–∏–π –¥–æ–∫—É–º–µ–Ω—Ç, —â–æ —Ñ—ñ–∫—Å—É—î —Ç–µ—Ö–Ω—ñ—á–Ω–∏–π —Å—Ç–∞–Ω —Ç–∞ —Ä–æ–∑—Ç–∞—à—É–≤–∞–Ω–Ω—è –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞.'
            },
            {
                id: 3,
                type: 'multiple2',
                points: 2,
                question: '–û–±–µ—Ä—ñ—Ç—å –î–í–ê –ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø—Ä–æ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞:',
                options: [
                    '–†—É—á–Ω—ñ –≥–∞–ª—å–º–∞ –ø—Ä–∏–≤–æ–¥—è—Ç—å—Å—è –≤ –¥—ñ—é –≤ –æ–±–æ—Ö –∫–∞–±—ñ–Ω–∞—Ö',
                    '–ì–∞–ª—å–º—ñ–≤–Ω—ñ –±–∞—à–º–∞–∫–∏ –ø—ñ–¥–∫–ª–∞–¥–∞—é—Ç—å—Å—è –ø—ñ–¥ —Å–µ—Ä–µ–¥–Ω—é –∫–æ–ª—ñ—Å–Ω—É –ø–∞—Ä—É',
                    '–ü—Ä–∏ –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—ñ —Ä—É—á–Ω–æ–≥–æ –≥–∞–ª—å–º–∞ –ø—ñ–¥–∫–ª–∞–¥–∞—é—Ç—å—Å—è –≥–∞–ª—å–º—ñ–≤–Ω—ñ –±–∞—à–º–∞–∫–∏',
                    '–ó–∞–ø–∏—Å —É –∂—É—Ä–Ω–∞–ª –¢–£-152 –Ω–µ —î –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–º'
                ],
                correct: [0, 2],
                explanation: '–†—É—á–Ω—ñ –≥–∞–ª—å–º–∞ –¥—ñ—é—Ç—å –≤ –æ–±–æ—Ö –∫–∞–±—ñ–Ω–∞—Ö, –∞ –ø—Ä–∏ —ó—Ö –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –≥–∞–ª—å–º—ñ–≤–Ω—ñ –±–∞—à–º–∞–∫–∏ –ø—ñ–¥ –∫—Ä–∞–π–Ω—é –∫–æ–ª—ñ—Å–Ω—É –ø–∞—Ä—É. –ó–∞–ø–∏—Å —É –∂—É—Ä–Ω–∞–ª –æ–±–æ–≤\'—è–∑–∫–æ–≤–∏–π.'
            },
            {
                id: 4,
                type: 'sequence',
                points: 2,
                question: '–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—É –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥—ñ–π –ø—Ä–∏ –∑–¥–∞—á—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞:',
                items: [
                    '–û–ø—É—Å—Ç–∏—Ç–∏ —Å—Ç—Ä—É–º–æ–ø—Ä–∏–π–º–∞—á—ñ',
                    '–ó–∞–≥–∞–ª—å–º—É–≤–∞—Ç–∏ —Ä—É—á–Ω–∏–º –≥–∞–ª—å–º–æ–º',
                    '–í—ñ–¥–∫–ª—é—á–∏—Ç–∏ –∞–∫—É–º—É–ª—è—Ç–æ—Ä–Ω—É –±–∞—Ç–∞—Ä–µ—é',
                    '–ó–∞–∫—Ä–∏—Ç–∏ –≤—ñ–∫–Ω–∞ —Ç–∞ –¥–≤–µ—Ä—ñ –Ω–∞ –∑–∞–ø—ñ—Ä–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó'
                ],
                correct: [1, 0, 2, 3],
                explanation: '–°–ø–æ—á–∞—Ç–∫—É –º–µ—Ö–∞–Ω—ñ—á–Ω–µ –∑–∞–∫—Ä—ñ–ø–ª–µ–Ω–Ω—è (–≥–∞–ª—å–º–æ), –ø–æ—Ç—ñ–º –∑–Ω–µ—Å—Ç—Ä—É–º–ª–µ–Ω–Ω—è (—Å—Ç—Ä—É–º–æ–ø—Ä–∏–π–º–∞—á—ñ), –¥–∞–ª—ñ –≤—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ê–ë, —ñ –Ω–∞—Ä–µ—à—Ç—ñ –∑–∞–∫—Ä–∏—Ç—Ç—è –ø—Ä–∏–º—ñ—â–µ–Ω—å.'
            },
            {
                id: 5,
                type: 'single',
                points: 1,
                question: '–Ø–∫–∏–π —Ç–µ—Ä–º—ñ–Ω –¥—ñ—ó –¥—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω–∏—Ö —Ä—É–∫–∞–≤–∏—Ü—å –º—ñ–∂ –µ–ª–µ–∫—Ç—Ä–æ–≤–∏–ø—Ä–æ–±—É–≤–∞–Ω–Ω—è–º–∏?',
                options: [
                    '3 –º—ñ—Å—è—Ü—ñ',
                    '6 –º—ñ—Å—è—Ü—ñ–≤',
                    '12 –º—ñ—Å—è—Ü—ñ–≤',
                    '24 –º—ñ—Å—è—Ü—ñ'
                ],
                correct: [1],
                explanation: '–î—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ —Ä—É–∫–∞–≤–∏—Ü—ñ –ø—ñ–¥–ª—è–≥–∞—é—Ç—å –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ–π –µ–ª–µ–∫—Ç—Ä–æ–≤–∏–ø—Ä–æ–±—É–≤–∞–Ω–Ω—é –∫–æ–∂–Ω—ñ 6 –º—ñ—Å—è—Ü—ñ–≤, –∫–∏–ª–∏–º–∫–∏ ‚Äî –∫–æ–∂–Ω—ñ 12 –º—ñ—Å—è—Ü—ñ–≤.'
            },
            {
                id: 6,
                type: 'multiple3',
                points: 3,
                question: '–û–±–µ—Ä—ñ—Ç—å –¢–†–ò –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –∑–∞—Å–æ–±–∏ –∑–∞—Ö–∏—Å—Ç—É –¥–ª—è –º–∞—à–∏–Ω—ñ—Å—Ç–∞ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞:',
                options: [
                    '–î—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ —Ä—É–∫–∞–≤–∏—Ü—ñ',
                    '–®—É–º–æ—ñ–∑–æ–ª—é—é—á—ñ –Ω–∞–≤—É—à–Ω–∏–∫–∏',
                    '–ü—Ä–æ—Ç–∏–≥–∞–∑',
                    '–®—Ç–∞–Ω–≥–∏ –¥–ª—è –∑–∞–∑–µ–º–ª–µ–Ω–Ω—è',
                    '–°–æ–Ω—Ü–µ–∑–∞—Ö–∏—Å–Ω—ñ –æ–∫—É–ª—è—Ä–∏',
                    '–†–µ—Å–ø—ñ—Ä–∞—Ç–æ—Ä'
                ],
                correct: [0, 1, 3],
                explanation: '–û–±–æ–≤\'—è–∑–∫–æ–≤—ñ –∑–∞—Å–æ–±–∏: –¥—ñ–µ–ª–µ–∫—Ç—Ä–∏—á–Ω—ñ —Ä—É–∫–∞–≤–∏—Ü—ñ (–∑–∞—Ö–∏—Å—Ç –≤—ñ–¥ —Å—Ç—Ä—É–º—É), —à—É–º–æ—ñ–∑–æ–ª—é—é—á—ñ –Ω–∞–≤—É—à–Ω–∏–∫–∏ (–∑–∞—Ö–∏—Å—Ç —Å–ª—É—Ö—É), —à—Ç–∞–Ω–≥–∏ –¥–ª—è –∑–∞–∑–µ–º–ª–µ–Ω–Ω—è (—Ä–æ–±–æ—Ç–∞ –ø—ñ–¥ –Ω–∞–ø—Ä—É–≥–æ—é). –ü—Ä–æ—Ç–∏–≥–∞–∑ ‚Äî –¥–ª—è –∞–≤–∞—Ä—ñ–π–Ω–∏—Ö —Å–∏—Ç—É–∞—Ü—ñ–π.'
            },
            {
                id: 7,
                type: 'single',
                points: 1,
                question: '–©–æ —Ç–∞–∫–µ "–∫–æ–ª—ñ—è –≤—ñ–¥—Å—Ç–æ—é"?',
                options: [
                    '–ö–æ–ª—ñ—è –¥–ª—è —Ä–µ–º–æ–Ω—Ç—É –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑—ñ–≤',
                    '–°–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –≤—ñ–¥–≤–µ–¥–µ–Ω–∞ –∫–æ–ª—ñ—è –¥–ª—è —Å—Ç–æ—è–Ω–∫–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤—ñ–≤ –º—ñ–∂ —Ä–µ–π—Å–∞–º–∏',
                    '–ö–æ–ª—ñ—è –¥–ª—è –º–∞–Ω–µ–≤—Ä–æ–≤–∏—Ö —Ä–æ–±—ñ—Ç',
                    '–ì–æ–ª–æ–≤–Ω–∞ –∫–æ–ª—ñ—è –¥–µ–ø–æ'
                ],
                correct: [1],
                explanation: '–ö–æ–ª—ñ—è –≤—ñ–¥—Å—Ç–æ—é ‚Äî —Å–ø–µ—Ü—ñ–∞–ª—å–Ω–æ –≤—ñ–¥–≤–µ–¥–µ–Ω–∞ –∫–æ–ª—ñ—è –¥–ª—è —Å—Ç–æ—è–Ω–∫–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤—ñ–≤ –º—ñ–∂ —Ä–µ–π—Å–∞–º–∏, –¥–µ –≤–æ–Ω–∏ –æ—á—ñ–∫—É—é—Ç—å –Ω–∞—Å—Ç—É–ø–Ω–æ–≥–æ –∑–∞–≤–¥–∞–Ω–Ω—è.'
            },
            {
                id: 8,
                type: 'matching',
                points: 4,
                question: '–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ —Ç–µ—Ä–º—ñ–Ω–æ–º —Ç–∞ –π–æ–≥–æ —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤–∫–æ—é:',
                left: ['–ù–ü–ê–û–ü', '–¢–£-152', '–ß–°', '–ê–ë'],
                right: [
                    '–ê–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–∞ –±–∞—Ç–∞—Ä–µ—è',
                    '–ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ',
                    '–ñ—É—Ä–Ω–∞–ª –æ–±–ª—ñ–∫—É –ª–æ–∫–æ–º–æ—Ç–∏–≤—ñ–≤',
                    '–ß–µ—Ö–æ—Å–ª–æ–≤–∞—Ü—å–∫–µ –≤–∏—Ä–æ–±–Ω–∏—Ü—Ç–≤–æ'
                ],
                correct: [1, 2, 3, 0],
                explanation: '–ù–ü–ê–û–ü ‚Äî –ù–æ—Ä–º–∞—Ç–∏–≤–Ω–∏–π –ü—Ä–∞–≤–æ–≤–∏–π –ê–∫—Ç –∑ –û—Ö–æ—Ä–æ–Ω–∏ –ü—Ä–∞—Ü—ñ, –¢–£-152 ‚Äî –∂—É—Ä–Ω–∞–ª –æ–±–ª—ñ–∫—É, –ß–° ‚Äî —á–µ—Ö–æ—Å–ª–æ–≤–∞—Ü—å–∫—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∏, –ê–ë ‚Äî –∞–∫—É–º—É–ª—è—Ç–æ—Ä–Ω–∞ –±–∞—Ç–∞—Ä–µ—è.'
            },
            {
                id: 9,
                type: 'single',
                points: 1,
                question: '–Ø–∫–∏–π –¥–æ–∫—É–º–µ–Ω—Ç –æ—Ç—Ä–∏–º—É—î –º–∞—à–∏–Ω—ñ—Å—Ç –ø–µ—Ä–µ–¥ —Ä–µ–π—Å–æ–º –∑ —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—î—é –ø—Ä–æ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä—É—Ö—É?',
                options: [
                    '–ñ—É—Ä–Ω–∞–ª –¢–£-152',
                    '–ë–ª–∞–Ω–∫ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å —Ñ. –î–£-61',
                    '–ù–ü–ê–û–ü 63.21-1.17-08',
                    '–Ü–Ω—Å—Ç—Ä—É–∫—Ü—ñ—è –¶–¢-0056'
                ],
                correct: [1],
                explanation: '–ë–ª–∞–Ω–∫ –ø–æ–ø–µ—Ä–µ–¥–∂–µ–Ω—å —Ñ. –î–£-61 –º—ñ—Å—Ç–∏—Ç—å —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é –ø—Ä–æ –æ—Å–æ–±–ª–∏–≤–æ—Å—Ç—ñ —Ä—É—Ö—É –ø–æ—ó–∑–¥–∞ –Ω–∞ –¥—ñ–ª—å–Ω–∏—Ü—ñ (—Ä–µ–º–æ–Ω—Ç–Ω—ñ —Ä–æ–±–æ—Ç–∏, –∑–º—ñ–Ω–∏ –≤ —Ä—É—Å—ñ, –æ–±–º–µ–∂–µ–Ω–Ω—è —à–≤–∏–¥–∫–æ—Å—Ç—ñ).'
            },
            {
                id: 10,
                type: 'multiple2',
                points: 2,
                question: '–û–±–µ—Ä—ñ—Ç—å –î–í–ê –ø—Ä–∞–≤–∏–ª—å–Ω—ñ —Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø—Ä–æ —Ä–µ–≤–µ—Ä—Å–∏–≤–Ω—É —Ä—É–∫–æ—è—Ç–∫—É:',
                options: [
                    '–í–æ–Ω–∞ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —á–µ—Ä–≥–æ–≤–æ–º—É –ø—Ä–∏ –∑–¥–∞—á—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞',
                    '–ù–∞ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞—Ö –ß–° –≤–æ–Ω–∞ –≤–±—É–¥–æ–≤–∞–Ω–∞ –≤ –ø—É–ª—å—Ç',
                    '–ú–æ–∂–Ω–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –Ω–µ—ñ–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ñ (—Å–∞–º–æ—Ä–æ–±–Ω—ñ) —Ä—É–∫–æ—è—Ç–∫–∏',
                    '–ë–µ–∑ –Ω–µ—ó –Ω–µ–º–æ–∂–ª–∏–≤–∏–π —Ä—É—Ö –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞'
                ],
                correct: [0, 1],
                explanation: '–†–µ–≤–µ—Ä—Å–∏–≤–Ω–∞ —Ä—É–∫–æ—è—Ç–∫–∞ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è —á–µ—Ä–≥–æ–≤–æ–º—É –ø—Ä–∏ –∑–¥–∞—á—ñ, –∞ –Ω–∞ –ß–° –≤–æ–Ω–∞ –≤–±—É–¥–æ–≤–∞–Ω–∞. –ù–µ—ñ–Ω–≤–µ–Ω—Ç–∞—Ä–Ω—ñ —Ä—É–∫–æ—è—Ç–∫–∏ –∑–∞–±–æ—Ä–æ–Ω–µ–Ω—ñ, —ñ –±–µ–∑ –Ω–µ—ó –¥—ñ–π—Å–Ω–æ –Ω–µ–º–æ–∂–ª–∏–≤–∏–π —Ä—É—Ö ‚Äî –∞–ª–µ —Ü–µ –Ω–µ —Å—Ç–æ—Å—É—î—Ç—å—Å—è –ß–°.'
            },
            {
                id: 11,
                type: 'sequence',
                points: 2,
                question: '–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –ø–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –¥—ñ–π –ø—Ä–∏ –ø—Ä–∏–π–º–∞–Ω–Ω—ñ –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞:',
                items: [
                    '–ü—Ä–æ–π—Ç–∏ –º–µ–¥–∏—á–Ω–∏–π –æ–≥–ª—è–¥',
                    '–û—Ç—Ä–∏–º–∞—Ç–∏ –∫–ª—é—á—ñ —Ç–∞ –±–ª–∞–Ω–∫ –î–£-61',
                    '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∑–∞—Å–æ–±–∏ –∑–∞—Ö–∏—Å—Ç—É',
                    '–ü–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –±–ª–æ–∫—É–≤–∞–ª—å–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó'
                ],
                correct: [0, 1, 2, 3],
                explanation: '–°–ø–æ—á–∞—Ç–∫—É –º–µ–¥–æ–≥–ª—è–¥, –ø–æ—Ç—ñ–º –æ—Ç—Ä–∏–º–∞–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤ —ñ –∫–ª—é—á—ñ–≤, –¥–∞–ª—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ –∑–∞—Å–æ–±—ñ–≤ –∑–∞—Ö–∏—Å—Ç—É, —ñ –Ω–∞—Ä–µ—à—Ç—ñ –ø–µ—Ä–µ–≤—ñ—Ä–∫–∞ —Ç–µ—Ö–Ω—ñ—á–Ω–∏—Ö –ø—Ä–∏—Å—Ç—Ä–æ—ó–≤.'
            },
            {
                id: 12,
                type: 'single',
                points: 1,
                question: '–©–æ —Ä–æ–±–∏—Ç–∏ –Ω–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞ –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é –¥–µ–ø–æ?',
                options: [
                    '–í–∫–ª—é—á–∏—Ç–∏ –∞–∫—É–º—É–ª—è—Ç–æ—Ä–Ω—É –±–∞—Ç–∞—Ä–µ—é',
                    '–û–ø—É—Å—Ç–∏—Ç–∏ —Å—Ç—Ä—É–º–æ–ø—Ä–∏–π–º–∞—á—ñ',
                    '–ü—Ä–æ–≤–µ—Å—Ç–∏ –ø—Ä–æ–±—É –∞–≤—Ç–æ–≥–∞–ª—å–º',
                    '–í—ñ–¥–∫—Ä–∏—Ç–∏ –≤—ñ–∫–Ω–∞ –¥–ª—è –ø—Ä–æ–≤—ñ—Ç—Ä—é–≤–∞–Ω–Ω—è'
                ],
                correct: [1],
                explanation: '–ù–µ–≥–∞–π–Ω–æ –ø—ñ—Å–ª—è –≤–≤–µ–¥–µ–Ω–Ω—è –Ω–∞ –ø–æ–∑–∏—Ü—ñ—é –æ–ø—É—Å–∫–∞—é—Ç—å—Å—è —Å—Ç—Ä—É–º–æ–ø—Ä–∏–π–º–∞—á—ñ –¥–ª—è –∑–Ω–µ—Å—Ç—Ä—É–º–ª–µ–Ω–Ω—è –µ–ª–µ–∫—Ç—Ä–æ–≤–æ–∑–∞ ‚Äî —Ü–µ –æ—Å–Ω–æ–≤–Ω–∞ –≤–∏–º–æ–≥–∞ –µ–ª–µ–∫—Ç—Ä–æ–±–µ–∑–ø–µ–∫–∏.'
            },
            {
                id: 13,
                type: 'multiple3',
                points: 3,
                question: '–û–±–µ—Ä—ñ—Ç—å –¢–†–ò –≤–∏–¥–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞–ª—å–Ω–æ—Å—Ç—ñ –∑–∞ –ø–æ—Ä—É—à–µ–Ω–Ω—è –≤–∏–º–æ–≥ –±–µ–∑–ø–µ–∫–∏:',
                options: [
                    '–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞—Ä–Ω–∞',
                    '–ú–æ—Ä–∞–ª—å–Ω–∞',
                    '–ê–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞',
                    '–ö—Ä–∏–º—ñ–Ω–∞–ª—å–Ω–∞',
                    '–ú–∞—Ç–µ—Ä—ñ–∞–ª—å–Ω–∞',
                    '–°–æ—Ü—ñ–∞–ª—å–Ω–∞'
                ],
                correct: [0, 2, 3],
                explanation: '–î–∏—Å—Ü–∏–ø–ª—ñ–Ω–∞—Ä–Ω–∞ (–¥–æ–≥–∞–Ω–∞, –∑–≤—ñ–ª—å–Ω–µ–Ω–Ω—è), –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–∞ (—à—Ç—Ä–∞—Ñ–∏) —Ç–∞ –∫—Ä–∏–º—ñ–Ω–∞–ª—å–Ω–∞ (–ø–æ–∑–±–∞–≤–ª–µ–Ω–Ω—è –≤–æ–ª—ñ –ø—Ä–∏ —Ç—è–∂–∫–∏—Ö –Ω–∞—Å–ª—ñ–¥–∫–∞—Ö).'
            },
            {
                id: 14,
                type: 'single',
                points: 1,
                question: '–Ø–∫–∞ –Ω–∞–ø—Ä—É–≥–∞ –≤ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ñ–π –º–µ—Ä–µ–∂—ñ –∑–º—ñ–Ω–Ω–æ–≥–æ —Å—Ç—Ä—É–º—É?',
                options: [
                    '10 –∫–í',
                    '15 –∫–í',
                    '25 –∫–í',
                    '35 –∫–í'
                ],
                correct: [2],
                explanation: '–ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞ –º–µ—Ä–µ–∂–∞ –∑–º—ñ–Ω–Ω–æ–≥–æ —Å—Ç—Ä—É–º—É –º–∞—î –Ω–∞–ø—Ä—É–≥—É 25 –∫–í, —â–æ —î —Å–º–µ—Ä—Ç–µ–ª—å–Ω–æ –Ω–µ–±–µ–∑–ø–µ—á–Ω–æ—é —ñ –≤–∏–º–∞–≥–∞—î —Å—É–≤–æ—Ä–æ–≥–æ –¥–æ—Ç—Ä–∏–º–∞–Ω–Ω—è –ø—Ä–∞–≤–∏–ª –µ–ª–µ–∫—Ç—Ä–æ–±–µ–∑–ø–µ–∫–∏.'
            },
            {
                id: 15,
                type: 'matching',
                points: 2,
                question: '–í—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å –º—ñ–∂ –¥—ñ—î—é —Ç–∞ —ó—ó –º–µ—Ç–æ—é:',
                left: ['–ü–µ—Ä–µ–∫—Ä–∏—Ç—Ç—è —Ä–æ–∑\'—î–¥–Ω—É–≤–∞–ª—å–Ω–∏—Ö –∫—Ä–∞–Ω—ñ–≤', '–í–∏–ø—É—Å–∫ –ø–æ–≤—ñ—Ç—Ä—è –∑ —Ä–µ–∑–µ—Ä–≤—É–∞—Ä—ñ–≤', '–í–∏–º–∫–Ω–µ–Ω–Ω—è –ê–ë', '–ó–∞–∫—Ä–∏—Ç—Ç—è –Ω–∞ –∑–∞–ø—ñ—Ä–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó'],
                right: [
                    '–ó–∞–ø–æ–±—ñ–≥–∞–Ω–Ω—è —Å–∞–º–æ—Ä–æ–∑—Ä—è–¥—É',
                    '–ó–Ω—è—Ç—Ç—è —Ç–∏—Å–∫—É –≤ –≥–∞–ª—å–º—ñ–≤–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ',
                    '–ü–æ–ø–µ—Ä–µ–¥–∂–µ–Ω–Ω—è –Ω–µ—Å–∞–Ω–∫—Ü—ñ–æ–Ω–æ–≤–∞–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø—É',
                    '–Ü–∑–æ–ª—è—Ü—ñ—è –≥–∞–ª—å–º—ñ–≤–Ω–æ—ó –º–∞–≥—ñ—Å—Ç—Ä–∞–ª—ñ'
                ],
                correct: [3, 1, 0, 2],
                explanation: '–ö—Ä–∞–Ω–∏ —ñ–∑–æ–ª—é—é—Ç—å –º–∞–≥—ñ—Å—Ç—Ä–∞–ª—å, –≤–∏–ø—É—Å–∫ –ø–æ–≤—ñ—Ç—Ä—è –∑–Ω—ñ–º–∞—î —Ç–∏—Å–∫, –≤–∏–º–∫–Ω–µ–Ω–Ω—è –ê–ë –∑–∞–ø–æ–±—ñ–≥–∞—î —Ä–æ–∑—Ä—è–¥—É, –∑–∞–ø—ñ—Ä–Ω—ñ –ø—Ä–∏—Å—Ç—Ä–æ—ó –∑–∞—Ö–∏—â–∞—é—Ç—å –≤—ñ–¥ –¥–æ—Å—Ç—É–ø—É.'
            }
        ];

        // State
        let currentQuestion = 0;
        let userAnswers = {};
        let testStartTime = null;
        let testEndTime = null;
        let timerInterval = null;
        let attemptNumber = 1;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            // Set current date
            const now = new Date();
            document.getElementById('testDate').value = now.toLocaleString('uk-UA');
            
            // Check localStorage for previous attempts
            const previousAttempts = localStorage.getItem('testAttempts');
            if (previousAttempts) {
                attemptNumber = parseInt(previousAttempts) + 1;
            }
        });

        // Start Test
        function startTest() {
            const name = document.getElementById('userName').value.trim();
            const group = document.getElementById('userGroup').value.trim();

            if (!name || !group) {
                alert('–ë—É–¥—å –ª–∞—Å–∫–∞, –∑–∞–ø–æ–≤–Ω—ñ—Ç—å –≤—Å—ñ –æ–±–æ–≤\'—è–∑–∫–æ–≤—ñ –ø–æ–ª—è (–ü–Ü–ë —Ç–∞ –ì—Ä—É–ø–∞)');
                return;
            }

            testStartTime = new Date();
            document.getElementById('registrationForm').classList.add('hidden');
            document.getElementById('testContainer').classList.remove('hidden');
            document.getElementById('timer').classList.remove('hidden');
            document.getElementById('navHeader').classList.add('visible');

            startTimer();
            renderAllQuestions();
            updateNav();
        }

        // Timer
        function startTimer() {
            const startTime = Date.now();
            const maxTime = 30 * 60 * 1000;

            timerInterval = setInterval(() => {
                const elapsed = Date.now() - startTime;
                const remaining = maxTime - elapsed;

                if (remaining <= 0) {
                    clearInterval(timerInterval);
                    finishTest();
                    return;
                }

                const minutes = Math.floor(remaining / 60000);
                const seconds = Math.floor((remaining % 60000) / 1000);
                document.getElementById('timerText').textContent = 
                    `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;

                if (remaining < 5 * 60 * 1000) {
                    document.getElementById('timer').classList.add('warning');
                }
            }, 1000);
        }

        // Render All Questions
        function renderAllQuestions() {
            const container = document.getElementById('questionsList');
            container.innerHTML = '';

            testData.forEach((q, index) => {
                const card = document.createElement('div');
                card.className = 'question-card';
                card.id = `question-${index}`;
                
                // Only show first question initially
                if (index !== 0) {
                    card.style.display = 'none';
                }

                let contentHtml = `
                    <div class="question-header">
                        <div class="question-number">${index + 1}</div>
                        <div style="flex: 1;">
                            <div class="question-type">${getQuestionTypeLabel(q.type)} ‚Ä¢ ${q.points} ${q.points === 1 ? '–±–∞–ª' : '–±–∞–ª–∏'}</div>
                        </div>
                    </div>
                    <div class="question-text">${q.question}</div>
                    <div class="question-points">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –º–æ–∂–ª–∏–≤–æ –Ω–∞–±—Ä–∞—Ç–∏: ${q.points} ${q.points === 1 ? '–±–∞–ª' : q.points < 5 ? '–±–∞–ª–∏' : '–±–∞–ª—ñ–≤'}</div>
                `;

                // Render options based on type
                if (q.type === 'single') {
                    contentHtml += renderSingleChoice(q, index);
                } else if (q.type === 'multiple2' || q.type === 'multiple3') {
                    contentHtml += renderMultipleChoice(q, index);
                } else if (q.type === 'sequence') {
                    contentHtml += renderSequence(q, index);
                } else if (q.type === 'matching') {
                    contentHtml += renderMatching(q, index);
                }

                card.innerHTML = contentHtml;
                container.appendChild(card);
            });
        }

        function renderSingleChoice(q, index) {
            let html = '<ul class="options-list">';
            q.options.forEach((opt, i) => {
                html += `
                    <li class="option-item">
                        <label class="option-label" onclick="selectOption(${index}, ${i}, 'radio')">
                            <input type="radio" 
                                   name="q${index}" 
                                   value="${i}" 
                                   class="option-input"
                                   onchange="saveAnswer(${index}, ${i}, 'radio')">
                            <span class="option-text">${opt}</span>
                        </label>
                    </li>
                `;
            });
            html += '</ul>';
            return html;
        }

        function renderMultipleChoice(q, index) {
            let html = '<ul class="options-list">';
            q.options.forEach((opt, i) => {
                html += `
                    <li class="option-item">
                        <label class="option-label" onclick="selectOption(${index}, ${i}, 'checkbox')">
                            <input type="checkbox" 
                                   name="q${index}" 
                                   value="${i}" 
                                   class="option-input"
                                   onchange="saveAnswer(${index}, ${i}, 'checkbox')">
                            <span class="option-text">${opt}</span>
                        </label>
                    </li>
                `;
            });
            html += '</ul>';
            return html;
        }

        function renderSequence(q, index) {
            let html = `<div class="sequence-container" id="sequence-${index}">`;
            q.items.forEach((item, i) => {
                html += `
                    <div class="sequence-item" draggable="true" data-index="${i}" ondragstart="dragStart(event)" ondragover="dragOver(event)" ondrop="drop(event, ${index})">
                        <div class="sequence-number">${i + 1}</div>
                        <div class="sequence-text">${item}</div>
                        <div class="sequence-handle">‚ãÆ‚ãÆ</div>
                    </div>
                `;
            });
            html += '</div>';
            html += `<button class="btn btn-secondary" onclick="saveSequence(${index})" style="margin-top: 1rem; max-width: 200px;">–ó–±–µ—Ä–µ–≥—Ç–∏ –ø–æ—Ä—è–¥–æ–∫</button>`;
            return html;
        }

        function renderMatching(q, index) {
            let html = '<div class="matching-container">';
            
            // Left column
            html += '<div class="matching-column">';
            q.left.forEach((item, i) => {
                html += `<div class="matching-item" onclick="selectMatch(${index}, 'left', ${i})" id="match-${index}-left-${i}">${item}</div>`;
            });
            html += '</div>';
            
            // Arrow
            html += '<div class="matching-arrow">‚Üî</div>';
            
            // Right column
            html += '<div class="matching-column">';
            q.right.forEach((item, i) => {
                html += `<div class="matching-item" onclick="selectMatch(${index}, 'right', ${i})" id="match-${index}-right-${i}">${item}</div>`;
            });
            html += '</div>';
            
            html += '</div>';
            html += `<div id="matches-${index}" style="margin-top: 1rem; font-size: 0.9rem;"></div>`;
            return html;
        }

        function getQuestionTypeLabel(type) {
            const labels = {
                'single': '–û–¥–∏–Ω–æ—á–Ω–∏–π –≤–∏–±—ñ—Ä',
                'multiple2': '–ú–Ω–æ–∂–∏–Ω–Ω–∏–π –≤–∏–±—ñ—Ä (2 –∑ 4)',
                'multiple3': '–ú–Ω–æ–∂–∏–Ω–Ω–∏–π –≤–∏–±—ñ—Ä (3 –∑ 6)',
                'sequence': '–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å',
                'matching': '–í—ñ–¥–ø–æ–≤—ñ–¥–Ω—ñ—Å—Ç—å'
            };
            return labels[type] || type;
        }

        // Navigation
        function updateNav() {
            document.getElementById('navStats').textContent = `–ü–∏—Ç–∞–Ω–Ω—è ${currentQuestion + 1}/${testData.length}`;
            const progress = ((currentQuestion + 1) / testData.length) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
        }

        function nextQuestion() {
            if (currentQuestion < testData.length - 1) {
                document.getElementById(`question-${currentQuestion}`).style.display = 'none';
                currentQuestion++;
                document.getElementById(`question-${currentQuestion}`).style.display = 'block';
                updateNav();
                document.getElementById(`question-${currentQuestion}`).scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function prevQuestion() {
            if (currentQuestion > 0) {
                document.getElementById(`question-${currentQuestion}`).style.display = 'none';
                currentQuestion--;
                document.getElementById(`question-${currentQuestion}`).style.display = 'block';
                updateNav();
                document.getElementById(`question-${currentQuestion}`).scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Save Answers
        function selectOption(qIndex, optIndex, type) {
            const labels = document.querySelectorAll(`#question-${qIndex} .option-label`);
            if (type === 'radio') {
                labels.forEach(l => l.classList.remove('selected'));
                labels[optIndex].classList.add('selected');
            } else {
                labels[optIndex].classList.toggle('selected');
            }
        }

        function saveAnswer(qIndex, optIndex, type) {
            if (!userAnswers[qIndex]) userAnswers[qIndex] = [];
            
            if (type === 'radio') {
                userAnswers[qIndex] = [optIndex];
            } else {
                const index = userAnswers[qIndex].indexOf(optIndex);
                if (index > -1) {
                    userAnswers[qIndex].splice(index, 1);
                } else {
                    userAnswers[qIndex].push(optIndex);
                }
            }
        }

        // Sequence Drag & Drop
        let draggedElement = null;

        function dragStart(e) {
            draggedElement = e.target.closest('.sequence-item');
            e.target.closest('.sequence-item').classList.add('dragging');
        }

        function dragOver(e) {
            e.preventDefault();
        }

        function drop(e, qIndex) {
            e.preventDefault();
            const target = e.target.closest('.sequence-item');
            if (draggedElement && target && draggedElement !== target) {
                const container = document.getElementById(`sequence-${qIndex}`);
                const allItems = [...container.querySelectorAll('.sequence-item')];
                const draggedIdx = allItems.indexOf(draggedElement);
                const targetIdx = allItems.indexOf(target);
                
                if (draggedIdx < targetIdx) {
                    target.after(draggedElement);
                } else {
                    target.before(draggedElement);
                }
                
                // Update numbers
                container.querySelectorAll('.sequence-item').forEach((item, i) => {
                    item.querySelector('.sequence-number').textContent = i + 1;
                });
            }
            if (draggedElement) {
                draggedElement.classList.remove('dragging');
            }
        }

        function saveSequence(qIndex) {
            const container = document.getElementById(`sequence-${qIndex}`);
            const items = container.querySelectorAll('.sequence-item');
            const order = [...items].map(item => parseInt(item.dataset.index));
            userAnswers[qIndex] = order;
            
            // Visual feedback
            const btn = event.target;
            const originalText = btn.textContent;
            btn.textContent = '‚úì –ó–±–µ—Ä–µ–∂–µ–Ω–æ';
            btn.style.background = 'var(--success)';
            btn.style.color = 'white';
            setTimeout(() => {
                btn.textContent = originalText;
                btn.style.background = '';
                btn.style.color = '';
            }, 1500);
        }

        // Matching
        let selectedMatch = null;

        function selectMatch(qIndex, side, index) {
            const item = document.getElementById(`match-${qIndex}-${side}-${index}`);
            
            if (!userAnswers[qIndex]) userAnswers[qIndex] = {};
            
            if (selectedMatch === null) {
                selectedMatch = { qIndex, side, index, element: item };
                item.classList.add('selected');
            } else {
                if (selectedMatch.qIndex === qIndex && selectedMatch.side !== side) {
                    // Create match
                    const leftIndex = selectedMatch.side === 'left' ? selectedMatch.index : index;
                    const rightIndex = selectedMatch.side === 'left' ? index : selectedMatch.index;
                    
                    userAnswers[qIndex][leftIndex] = rightIndex;
                    
                    // Visual feedback
                    selectedMatch.element.classList.remove('selected');
                    selectedMatch.element.classList.add('matched');
                    item.classList.add('matched');
                    
                    // Show matches
                    updateMatchesDisplay(qIndex);
                    
                    selectedMatch = null;
                } else {
                    // Deselect
                    selectedMatch.element.classList.remove('selected');
                    selectedMatch = null;
                }
            }
        }

        function updateMatchesDisplay(qIndex) {
            const container = document.getElementById(`matches-${qIndex}`);
            const matches = userAnswers[qIndex] || {};
            let html = '<strong>–í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ:</strong><br>';
            for (let [left, right] of Object.entries(matches)) {
                html += `${testData[qIndex].left[left]} ‚Üí ${testData[qIndex].right[right]}<br>`;
            }
            container.innerHTML = html;
        }

        // Finish Test
        function finishTest() {
            clearInterval(timerInterval);
            testEndTime = new Date();
            
            // Save attempt number
            localStorage.setItem('testAttempts', attemptNumber);
            
            // Calculate results
            const results = calculateResults();
            
            // Show results
            showResults(results);
        }

        function calculateResults() {
            let totalScore = 0;
            let maxScore = 0;
            const details = [];

            testData.forEach((q, index) => {
                const userAnswer = userAnswers[index] || [];
                const correct = q.correct;
                let score = 0;
                let status = 'incorrect';

                maxScore += q.points;

                if (q.type === 'single') {
                    if (userAnswer.length === 1 && userAnswer[0] === correct[0]) {
                        score = q.points;
                        status = 'correct';
                    } else if (userAnswer.length === 0) {
                        status = 'unanswered';
                    }
                } else if (q.type === 'multiple2') {
                    const correctCount = userAnswer.filter(a => correct.includes(a)).length;
                    const incorrectCount = userAnswer.filter(a => !correct.includes(a)).length;
                    
                    if (correctCount === 2 && incorrectCount === 0) {
                        score = 2;
                        status = 'correct';
                    } else if (correctCount === 1 && incorrectCount === 0) {
                        score = 1;
                        status = 'partial';
                    } else if (correctCount > 0 || incorrectCount > 0) {
                        score = Math.max(0, correctCount - incorrectCount * 0.5);
                        status = score > 0 ? 'partial' : 'incorrect';
                    } else {
                        status = 'unanswered';
                    }
                } else if (q.type === 'multiple3') {
                    const correctCount = userAnswer.filter(a => correct.includes(a)).length;
                    const incorrectCount = userAnswer.filter(a => !correct.includes(a)).length;
                    
                    score = Math.max(0, correctCount - incorrectCount * 0.5);
                    if (score === 3) status = 'correct';
                    else if (score > 0) status = 'partial';
                    else if (userAnswer.length === 0) status = 'unanswered';
                } else if (q.type === 'sequence') {
                    if (Array.isArray(userAnswer) && userAnswer.length === correct.length) {
                        let correctPositions = 0;
                        userAnswer.forEach((val, idx) => {
                            if (val === correct[idx]) correctPositions++;
                        });
                        score = (correctPositions / correct.length) * q.points;
                        if (score === q.points) status = 'correct';
                        else if (score > 0) status = 'partial';
                    } else if (userAnswer.length === 0) {
                        status = 'unanswered';
                    }
                } else if (q.type === 'matching') {
                    const matches = userAnswer || {};
                    let correctMatches = 0;
                    for (let i = 0; i < correct.length; i++) {
                        if (matches[i] === correct[i]) correctMatches++;
                    }
                    score = (correctMatches / correct.length) * q.points;
                    if (score === q.points) status = 'correct';
                    else if (score > 0) status = 'partial';
                    else if (Object.keys(matches).length === 0) status = 'unanswered';
                }

                totalScore += score;
                details.push({
                    question: q,
                    userAnswer: userAnswer,
                    score: score,
                    maxScore: q.points,
                    status: status
                });
            });

            return { totalScore, maxScore, details };
        }

        function showResults(results) {
            document.getElementById('testContainer').classList.add('hidden');
            document.getElementById('timer').classList.add('hidden');
            document.getElementById('resultsContainer').classList.remove('hidden');

            // Calculate final grade (0-10)
            const grade = (results.totalScore / results.maxScore * 10).toFixed(1);
            
            // Update header
            document.getElementById('finalScore').textContent = `${results.totalScore.toFixed(1)}/${results.maxScore}`;
            document.getElementById('scoreLabel').textContent = `–û—Ü—ñ–Ω–∫–∞: ${grade}/10`;

            // Update stats
            const correct = results.details.filter(d => d.status === 'correct').length;
            const partial = results.details.filter(d => d.status === 'partial').length;
            const incorrect = results.details.filter(d => d.status === 'incorrect').length;
            
            document.getElementById('correctCount').textContent = correct;
            document.getElementById('partialCount').textContent = partial;
            document.getElementById('incorrectCount').textContent = incorrect;

            // Time spent
            const timeSpent = Math.floor((testEndTime - testStartTime) / 1000);
            const minutes = Math.floor(timeSpent / 60);
            const seconds = timeSpent % 60;
            document.getElementById('timeSpent').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('attemptNumber').textContent = attemptNumber;

            // Answer Grid
            const grid = document.getElementById('answerGrid');
            grid.innerHTML = '';
            results.details.forEach((d, i) => {
                const cell = document.createElement('div');
                cell.className = `answer-cell ${d.status}`;
                cell.textContent = i + 1;
                cell.onclick = () => scrollToQuestion(i);
                grid.appendChild(cell);
            });

            // Report Data
            document.getElementById('reportName').textContent = document.getElementById('userName').value;
            document.getElementById('reportGroup').textContent = document.getElementById('userGroup').value;
            document.getElementById('reportDateTime').textContent = testEndTime.toLocaleString('uk-UA');
            document.getElementById('reportDuration').textContent = 
                `${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
            document.getElementById('reportAttempt').textContent = attemptNumber;
            document.getElementById('calcEarned').textContent = results.totalScore.toFixed(1);
            document.getElementById('calcFinal').textContent = grade;

            // Questions Detail
            const detailContainer = document.getElementById('questionsDetail');
            detailContainer.innerHTML = '';
            
            results.details.forEach((d, i) => {
                const div = document.createElement('div');
                div.style.cssText = 'margin-bottom: 1.5rem; padding: 1rem; background: var(--bg); border-radius: 10px;';
                
                let statusText = '';
                let statusColor = '';
                switch(d.status) {
                    case 'correct': statusText = '‚úì –ü—Ä–∞–≤–∏–ª—å–Ω–æ'; statusColor = 'var(--success)'; break;
                    case 'partial': statusText = '‚óê –ß–∞—Å—Ç–∫–æ–≤–æ'; statusColor = 'var(--warning)'; break;
                    case 'incorrect': statusText = '‚úó –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ'; statusColor = 'var(--danger)'; break;
                    case 'unanswered': statusText = '‚óã –ë–µ–∑ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ'; statusColor = 'var(--text-light)'; break;
                }

                let userAnswerText = '';
                if (d.question.type === 'single' || d.question.type.includes('multiple')) {
                    userAnswerText = d.userAnswer.map(i => d.question.options[i]).join(', ') || '–ù–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ';
                } else if (d.question.type === 'sequence') {
                    userAnswerText = d.userAnswer.length ? '–ü–æ—Å–ª—ñ–¥–æ–≤–Ω—ñ—Å—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞' : '–ù–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ';
                } else if (d.question.type === 'matching') {
                    userAnswerText = Object.keys(d.userAnswer).length ? '–í—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ—Å—Ç—ñ –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ñ' : '–ù–µ–º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ';
                }

                div.innerHTML = `
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 0.5rem;">
                        <strong>–ü–∏—Ç–∞–Ω–Ω—è ${i + 1}</strong>
                        <span style="color: ${statusColor}; font-weight: 600;">${statusText} (${d.score.toFixed(1)}/${d.maxScore})</span>
                    </div>
                    <div style="font-size: 0.9rem; color: var(--text-light); margin-bottom: 0.5rem;">
                        ${d.question.question}
                    </div>
                    <div style="font-size: 0.85rem; margin-bottom: 0.5rem;">
                        <strong>–í–∞—à–∞ –≤—ñ–¥–ø–æ–≤—ñ–¥—å:</strong> ${userAnswerText}
                    </div>
                    <div style="font-size: 0.85rem; color: var(--secondary); font-style: italic;">
                        <strong>–ü–æ—è—Å–Ω–µ–Ω–Ω—è:</strong> ${d.question.explanation}
                    </div>
                `;
                detailContainer.appendChild(div);
            });
        }

        function scrollToQuestion(index) {
            const element = document.getElementById(`question-${index}`);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        }

        function restartTest() {
            location.reload();
        }

        // Scroll events
        let ticking = false;
        window.addEventListener('scroll', () => {
            if (!ticking) {
                window.requestAnimationFrame(() => {
                    const scrollTop = window.scrollY;
                    if (scrollTop > 300) {
                        document.getElementById('navHeader').classList.add('visible');
                    } else {
                        document.getElementById('navHeader').classList.remove('visible');
                    }
                    ticking = false;
                });
                ticking = true;
            }
        });
    </script>

</body>
</html>